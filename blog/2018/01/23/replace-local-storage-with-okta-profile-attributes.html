<!doctype html>
<!--[if lt IE 7 ]> <html class="ie6 no-flexbox"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7 no-flexbox"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8 no-flexbox"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9 no-flexbox"> <![endif]-->
<!--[if IE 10 ]>    <html class="ie10 no-flexbox"> <![endif]-->
<!--[if (gt IE 10)|!(IE)]><!--> <html class="modern wf-loading" lang="en"> <!--<![endif]-->
  <head>
  <script>
    var searchDomain = 'https://developer.okta.com';
    var isProduction = window.location.hostname === 'developer.okta.com';
    if (isProduction) {
      // TypeKit
      (function(d) {
        var config = {
          kitId: 'jff5neq',
          scriptTimeout: 3000,
          async: true
        },
        h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/bwf-loadingb/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
      })(document);

      // Google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-15777010-3', 'auto');
      ga('send', 'pageview');

      // START Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TJ45R6');
      // END Google Tag Manager

      // Start Heap Analytics
      window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
      heap.load("3356162945");
      // End Heap Analytics
    }
  </script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   

  <link type="text/css" rel="stylesheet" href="https://developer.okta.com/sites/all/themes/developer/css/master.css" media="all" />
  <meta class="swiftype" name="title" data-type="string" content="Use Okta (Instead of Local Storage) to Store Your User’s Data Securely | Okta Developer">
  <meta class="swiftype" name="summary" data-type="string" content="Using an Okta Developer account will allow you to store your cryptocurrency holdings as custom profile attributes instead of using local storage. While LocalStorage is great for demos, using custom profile attributes will allow you to access your data across different devices." />

  <link type="text/css" rel="stylesheet" href="/assets/animate-ec43d72c3ed45e08a460b8a2966d8dba6006aebfa0530935c3973fa493a8771f.css">
  <link type="text/css" rel="stylesheet" href="/assets/okta-5709780bae87480dbcdc9610d80786f64ecd7c7f9f16a3215f689067ddb318f4.css">
  
  
  <title>Use Okta (Instead of Local Storage) to Store Your User’s Data Securely | Okta Developer</title>
  <meta name="description" content="Using an Okta Developer account will allow you to store your cryptocurrency holdings as custom profile attributes instead of using local storage. While LocalStorage is great for demos, using custom profile attributes will allow you to access your data across different devices.">
  <link rel="alternate" type="application/rss+xml" title="Okta Developer" href="https://developer.okta.com/feed.xml"><!-- GA -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets/favicon/manifest.json">
  <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#21313a">
  <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
</head>

  
    <body id="blog">
	




<header class="Header is-fixed">

  <div class="Wrap">

    <a class="Logo" href="https://developer.okta.com">
      <svg version="1.1" id="OktaLogo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 431.9 151.4" style="enable-background:new 0 0 431.9 151.4;" xml:space="preserve"><g><g><g><path d="M102.2,41.4c-21,0-38.1,17.1-38.1,38.1s17.1,38.1,38.1,38.1s38.1-17.1,38.1-38.1l0,0C140.3,58.5,123.2,41.4,102.2,41.4z M102.2,98.5c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19c0.1,10.5-8.4,19-18.9,19.1C102.3,98.6,102.2,98.6,102.2,98.5L102.2,98.5z"/><path d="M169.1,92.3c0-1.9,1.5-3.4,3.4-3.4c0.9,0,1.8,0.4,2.4,1c9.5,9.7,25.3,26.3,25.4,26.4c0.4,0.5,0.8,0.8,1.4,0.9l1.6,0.2h17.2c1.8,0,3.3-1.4,3.4-3.2c0-0.8-0.3-1.5-0.8-2.2l-28.6-29.2l-1.5-1.5c-3.2-3.9-2.9-5.4,0.8-9.3l22.6-25.1c1.1-1.4,0.8-3.5-0.6-4.6c-0.6-0.4-1.3-0.7-2-0.7h-17c-0.6,0.2-1.1,0.5-1.5,0.9L175,64.4c-1.3,1.4-3.4,1.5-4.8,0.2c-0.7-0.6-1.1-1.5-1.1-2.5V18.9c0-1.7-1.3-3-3-3c-0.1,0-0.2,0-0.3,0h-12.7c-2.2,0-3.3,1.5-3.3,2.8v95.8c0,2.2,1.8,2.8,3.3,2.8h12.7c1.7,0.1,3.2-1.2,3.3-2.9c0,0,0,0,0,0V92.3z"/><path d="M273,114l-1.4-12.8c-0.2-1.7-1.7-2.9-3.4-2.7c0,0,0,0-0.1,0l-2.9,0.2c-10.1,0-18.5-7.9-19-18c0-0.3,0-0.7,0-1V64.2c-0.1-2,1.5-3.6,3.5-3.7c0,0,0,0,0,0h17c1.7-0.1,3.1-1.5,3-3.2c0,0,0-0.1,0-0.1v-12c0-2.3-1.5-3.6-2.8-3.6h-17.1c-1.9,0.1-3.5-1.5-3.6-3.4c0,0,0,0,0,0V18.9c-0.1-1.7-1.5-3.1-3.2-3c0,0-0.1,0-0.1,0h-12.7c-1.6-0.1-3,1.1-3.1,2.7c0,0.1,0,0.1,0,0.2c0,0,0,61.7,0,62c0.5,21,17.9,37.6,38.9,37c1.4,0,2.9-0.2,4.3-0.3C272,117.2,273.2,115.7,273,114z"/></g><path d="M364.7,98c-10.8,0-12.4-3.8-12.4-18.3l0,0V44.8c0-1.8-1.4-3.2-3.2-3.2c0,0-0.1,0-0.1,0h-12.8c-1.8,0-3.2,1.4-3.3,3.2v1.6C314.6,36,291.3,42.5,281,60.8c-10.4,18.3-3.9,41.6,14.4,51.9c14,7.9,31.4,6.2,43.5-4.2c3.6,5.5,9.3,9.1,18.3,9.1c1.5,0,9.7,0.3,9.7-3.5v-13.6C367,99.2,366,98.1,364.7,98z M314.2,98.6c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19l0,0C333.2,90.1,324.7,98.6,314.2,98.6z"/></g><path d="M19.4,74c2.2-1.9,4.1-4.1,5.7-6.6c3.5-5.3,5.4-11.5,5.2-17.9V27c0-4.9,0.9-8.4,2.7-10.5c1.8-2.1,4.8-3,9.2-3h12.6c1.2,0,2.1-0.9,2.2-2.1l0,0V2.2C57,1,56,0,54.8,0c0,0,0,0,0,0H41.5c-7.8,0-12.9,2.1-18,7.6s-7.1,12.3-7.1,21.7v14.2c0,2.2-0.1,4-0.2,5.7v2.2c-0.5,3.2-1.8,6.2-3.6,8.9C9.4,64.7,5.1,70.9,0.9,74l0,0l-0.3,0.3l0,0l-0.2,0.3H0.2v0.3l0,0c-0.1,0.3-0.1,0.7,0,1l0,0v0.3h0.1l0.2,0.3l0,0l0.3,0.3l0,0c4.2,3.1,8.5,9.3,11.3,13.7c1.8,2.7,3.1,5.7,3.6,8.9v2.2c0.1,1.6,0.2,3.5,0.2,5.7v14.3c0,9.4,2.4,16.7,7.1,21.7s10.2,7.6,18,7.6h13.8c1.2,0,2.2-1,2.2-2.2V140l0,0c0-1.2-1-2.2-2.2-2.2H42.2c-4.4,0-7.5-1-9.2-3s-2.7-5.6-2.7-10.5v-22.4c0.2-6.4-1.7-12.6-5.2-17.9c-1.6-2.5-3.5-4.7-5.7-6.6l0,0c-0.9-0.7-1.1-2-0.4-2.9C19.2,74.3,19.3,74.2,19.4,74L19.4,74z"/><path d="M412.5,74c-2.2-1.9-4.1-4.1-5.7-6.6c-3.5-5.3-5.4-11.5-5.2-17.9V27c0-4.9-0.9-8.4-2.7-10.5s-4.8-3-9.2-3h-12.6c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0l0,0V2.2c0-1.2,1-2.2,2.2-2.2c0,0,0,0,0,0h13.4c7.8,0,12.9,2.1,18,7.6s7.1,12.3,7.1,21.7v14.2c0,2.2,0.1,4,0.2,5.7v2.2c0.5,3.2,1.8,6.2,3.6,8.9c2.8,4.5,7.1,10.7,11.3,13.7l0,0l0.3,0.3l0,0l0.2,0.3h0.1v0.3l0,0c0.1,0.3,0.1,0.7,0,1l0,0v0.3h-0.1l-0.2,0.3l0,0l-0.3,0.3l0,0c-4.2,3.1-8.5,9.3-11.3,13.7c-1.8,2.7-3.1,5.7-3.6,8.9v2.2c-0.1,1.6-0.2,3.5-0.2,5.7v14.3c0,9.4-2.4,16.7-7.1,21.7s-10.2,7.6-18,7.6h-13.4c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0V140l0,0c0-1.2,1-2.2,2.2-2.2l0,0h12.7c4.4,0,7.5-1,9.2-3s2.7-5.6,2.7-10.5v-22.4c-0.2-6.3,1.6-12.6,5.1-17.9c1.6-2.5,3.5-4.7,5.7-6.6l0,0c0.9-0.7,1.1-2,0.4-2.9C412.7,74.3,412.6,74.2,412.5,74L412.5,74z"/></g></svg>
    </a>

    <nav class="Header-nav PrimaryNav">
      <ul class="menu">
        <li class="first expanded">
          <a href="https://developer.okta.com/product/">Product</a>
          <ul class="menu">
            <li class="first leaf"><a href="https://developer.okta.com/product/">Overview</a></li>
            <li class="leaf"><a href="https://developer.okta.com/product/authentication/">Authentication</a></li>
            <li class="leaf"><a href="https://developer.okta.com/product/authorization/">Authorization</a></li>
            <li class="last leaf"><a href="https://developer.okta.com/product/user-management/">User Management</a></li>
          </ul>
        </li>
        <li class="leaf">
          <a href="https://developer.okta.com/pricing/">Pricing</a>
        </li>
        <li class="leaf">
          <a href="/blog/" class="active">Blog</a>
        </li>
        <li class="leaf">
          <a href="/documentation/">Docs</a>
        </li>
        <li class="last expanded">
          <span class="nolink">Support</span>
          <ul class="menu">
            <li class="first leaf"><a href="https://devforum.okta.com/">Okta Developer Forums</a></li>
            <li class="last leaf"><a href="mailto:developers@okta.com">developers@okta.com</a></li>
          </ul>
        </li>
      </ul>
      <a class="PrimaryNav-toggle" href="#">
        <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g class="MenuIcon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
                <path d="M1,16 L19,16" class="MenuIcon-line1" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,4 L19,4" class="MenuIcon-line2" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,10 L19,10" class="MenuIcon-line3" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,10 L19,10" class="MenuIcon-line4" stroke="#FFFFFF" stroke-width="2"></path>
            </g>
        </svg>
        <svg class="CloseIcon" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="ALl-Boards" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="Desktop" transform="translate(-915.000000, -235.000000)" fill="#FFFFFF">
              <g id="Search-bar-Active" transform="translate(30.000000, 26.000000)">
                <polygon id="Icon/Cross" points="901 210.6 899.4 209 893 215.4 886.6 209 885 210.6 891.4 217 885 223.4 886.6 225 893 218.6 899.4 225 901 223.4 894.6 217"></polygon>
              </g>
            </g>
          </g>
        </svg>
      </a>

      <div class="PrimaryNav-cta">
        <a target="_blank" rel="noopener noreferrer" href="https://login.okta.com/?SAMLRequest=fc%2B7CsJAEAXQXvAflu1NNJUMeZBGELTx1a%2FrYILJTtyZGD%2FfSBRiYzlw77lMnD3rSj3Qc0ku0YtgrhU6S5fSXRN9PKxmS52l00nMpq6iBvJWCrfDe4ss6vStRe9aDzmGIZfo1jsgwyWDMzUyiIV9vt1AH4XGk5ClSvewUgMNa%2BYW%2FVj5jxhm9NLP67QQaSAMu64L6CYmsFSHlnzT4ZlLwTgcL6Sf8%2FeX9AU%3Dhttps://login.okta.com/?SAMLRequest=fc%2B7CsJAEAXQXvAflu1NNJUMeZBGELTx1a%2FrYILJTtyZGD%2FfSBRiYzlw77lMnD3rSj3Qc0ku0YtgrhU6S5fSXRN9PKxmS52l00nMpq6iBvJWCrfDe4ss6vStRe9aDzmGIZfo1jsgwyWDMzUyiIV9vt1AH4XGk5ClSvewUgMNa%2BYW%2FVj5jxhm9NLP67QQaSAMu64L6CYmsFSHlnzT4ZlLwTgcL6Sf8%2FeX9AU%3D" class="Button--redOutline">Login</a>
        <a href="https://developer.okta.com/signup/" class="Button--red">Sign up</a>
      </div>

      <a class="SearchIcon" href="#"></a>
      <form id="form_search" class="SearchBar Formisimo_clocked_69929" method="get" action="https://developer.okta.com/search/" name="form_search" __bizdiag="-784164280" __biza="WJ__">
        <input type="text" name="stq" autocomplete="off" id="st-search-input-auto" class="st-search-input" placeholder="Search">
        <input type="submit" name="submit" value="GO">
      </form>

    </nav>

  </div>

</header>

	<div class="page-content">
		
		






<section class="Blog is-single">
		
	<div class="Blog-social">
		
		<a href="https://github.com/mraible" target="_blank"><i class="fa fa-github"></i></a>
		
		
		<a href="https://twitter.com/mraible" target="_blank"><i class="fa fa-twitter"></i></a>
		
		
		
		<a href="http://raibledesigns.com" target="_blank"><i class="fa fa-external-link"></i></a>
		
	</div>
	
	

<article class="BlogPost">

    <header class="BlogPost-header">

        <time class="BlogPost-date" datetime="2018-01-23">January 23, 2018</time>

        <h1 class="BlogPost-title">
            
            Use Okta (Instead of Local Storage) to Store Your User’s Data Securely
            
        </h1>

        <div class="BlogPost-attribution">
            
            <img src="/assets/avatar-matt_raible-9974af6192eb1753b7137c8fff0a2c6e6bb9736a2517986cb5cc50bb040e83d4.jpg" alt="avatar-matt_raible.jpg" class="BlogPost-avatar">
            
            <span class="BlogPost-author">Matt Raible</span>
        </div>

    </header>

    <div class="BlogPost-content">
        
	<p>Local Storage is a JavaScript API technically known as <code class="highlighter-rouge">localStorage</code> that arrived with HTML5. It allows you to store information on a user’s browser quickly and easily. There are many debates on the web as to whether it’s better than cookies. Some say it’s faster (because it doesn’t send data with every request like cookies do) and more secure.
Whether it’s more secure or not is debatable, especially when compared with secure cookies that have an <a href="https://www.owasp.org/index.php/HttpOnly">HttpOnly flag</a>. It does, however, offer the ability to store a lot more data than cookies. Cookies <a href="http://browsercookielimits.squawky.net/">can hold up to 4KB</a>, while local storage <a href="https://www.html5rocks.com/en/tutorials/offline/quota-research/">can hold 5MB or more</a>, depending on your browser.</p>

<h2 id="the-local-storage-api">The Local Storage API</h2>

<p>The local storage API is simple in that it only has a couple of methods to set and get data. In a <a href="/blog/2018/01/18/cryptocurrency-pwa-secured-by-okta">previous article</a>, I showed you how to build a PWA that stores your cryptocurrency holdings. In its <code class="highlighter-rouge">src/providers/holdings/holdings.ts</code> service, you can see how the local storage API works.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">saveHoldings</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="s1">'cryptoHoldings'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">holdings</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">loadHoldings</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'cryptoHoldings'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">holdings</span> <span class="o">=&gt;</span> <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">holdings</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">holdings</span> <span class="o">=</span> <span class="nx">holdings</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">fetchPrices</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="switch-from-local-storage-to-okta-custom-profile-attributes">Switch from Local Storage to Okta Custom Profile Attributes</h2>

<p>In <a href="/blog/2018/01/18/cryptocurrency-pwa-secured-by-okta">a previous article</a>, I showed you how to add Okta to an Ionic PWA for authentication. To complete this tutorial, you’ll need to <a href="https://developer.okta.com/signup/">sign up for a free Okta Developer account</a>.</p>

<p>Once you have an Okta Developer account, you can leverage our API to store your holdings as custom profile attributes instead of local storage. While LocalStorage is great for demos, using custom profile attributes will allow you to access your holdings across different devices.</p>

<blockquote>
  <p>To learn more about Okta’s Universal Directory and its Profile Editor features, see our <a href="https://help.okta.com/en/prod/Content/Topics/Directory/Directory_Profile_Editor.htm">manage user profiles</a> documentation.</p>
</blockquote>

<h3 id="add-a-holdings-attribute-to-your-user-profiles">Add a Holdings Attribute to your User Profiles</h3>

<p>The first thing you’ll need to do is add a <code class="highlighter-rouge">holdings</code> attribute to your organization’s user profiles. Log in to the Okta Developer Console, then navigate to <strong>Users</strong> &gt; <strong>Profile Editor</strong>. Click on <strong>Profile</strong> button for the first profile in the table. You can identify it by its Okta logo. Click <strong>Add Attribute</strong> and use the following values:</p>

<ul>
  <li>Display name: <code class="highlighter-rouge">Holdings</code></li>
  <li>Variable name: <code class="highlighter-rouge">holdings</code></li>
  <li>Description: <code class="highlighter-rouge">Cryptocurrency Holdings</code></li>
</ul>

<p><img src="/assets/blog/cryptocurrency-pwa-java-sdk/holdings-attribute-17ff3af1e65a159f7d91e15d23deb6b9d6972f529fd157757ddb442decc7688f.png" alt="Holdings Attribute" width="800" class="center-image" /></p>

<p>Use the default values for everything else and click <strong>Save</strong>.</p>

<h2 id="create-a-spring-boot-app">Create a Spring Boot App</h2>

<p>Head on over to <a href="https://start.spring.io">start.spring.io</a> and create a new Spring Boot project with a dependency on <strong>Web</strong>. You can use whatever group and artifact coordinates you like, but the code in this tutorial will match the following:</p>

<ul>
  <li>Group: <code class="highlighter-rouge">com.okta.developer</code></li>
  <li>Artifact: <code class="highlighter-rouge">holdings-api</code></li>
</ul>

<p><img src="/assets/blog/cryptocurrency-pwa-java-sdk/start-holdings-api-f7a1aec3a6f1ab15ac7be0451697896660862afb97619437f9901fd3eec65a55.png" alt="Holdings API App" width="800" class="center-image" /></p>

<p>Click <strong>Generate Project</strong> and expand <code class="highlighter-rouge">holdings-api.zip</code> after it finishes downloading.</p>

<p>Create a directory to hold your Spring Boot project and the Cryptocurrency PWA from the <a href="/blog/2018/01/18/cryptocurrency-pwa-secured-by-okta">previous tutorial</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir okta-ionic-crypto-java-sdk
mv ~/Downloads/holdings-api okta-ionic-crypto-java-sdk
git clone https://github.com/oktadeveloper/okta-ionic-crypto-pwa.git crypto-pwa
rm <span class="nt">-rf</span> crypto-pwa/.git
mv crypto-pwa okta-ionic-crypto-java-sdk
</code></pre></div></div>

<p>When finished, you should have a directory structure like the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>okta-ionic-crypto-java-sdk
  - holdings-api
  - crypto-pwa
</code></pre></div></div>

<p>Open the project in your favorite IDE or text editor.</p>

<h3 id="add-the-okta-spring-boot-starter-and-oktas-java-sdk">Add the Okta Spring Boot Starter and Okta’s Java SDK</h3>

<p>Open <code class="highlighter-rouge">holdings-api/pom.xml</code> and add dependencies for the <a href="https://github.com/okta/okta-spring-boot">Okta Spring Boot Starter</a> and the <a href="https://github.com/okta/okta-sdk-java">Okta Java SDK</a>.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;properties&gt;</span>
   ...
   <span class="nt">&lt;okta.version&gt;</span>0.3.0<span class="nt">&lt;/okta.version&gt;</span>
<span class="nt">&lt;/properties&gt;</span>

<span class="nt">&lt;dependencies&gt;</span>
   ...
   <span class="nt">&lt;dependency&gt;</span>
       <span class="nt">&lt;groupId&gt;</span>com.okta.spring<span class="nt">&lt;/groupId&gt;</span>
       <span class="nt">&lt;artifactId&gt;</span>okta-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
       <span class="nt">&lt;version&gt;</span>${okta.version}<span class="nt">&lt;/version&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;dependency&gt;</span>
       <span class="nt">&lt;groupId&gt;</span>com.okta.spring<span class="nt">&lt;/groupId&gt;</span>
       <span class="nt">&lt;artifactId&gt;</span>okta-spring-sdk<span class="nt">&lt;/artifactId&gt;</span>
       <span class="nt">&lt;version&gt;</span>${okta.version}<span class="nt">&lt;/version&gt;</span>
   <span class="nt">&lt;/dependency&gt;</span>
   ...
<span class="nt">&lt;/dependencies&gt;</span>

<span class="nt">&lt;dependencyManagement&gt;</span>
   <span class="nt">&lt;dependencies&gt;</span>
       <span class="nt">&lt;dependency&gt;</span>
           <span class="nt">&lt;groupId&gt;</span>org.springframework.security.oauth<span class="nt">&lt;/groupId&gt;</span>
           <span class="nt">&lt;artifactId&gt;</span>spring-security-oauth2<span class="nt">&lt;/artifactId&gt;</span>
           <span class="nt">&lt;version&gt;</span>2.2.0.RELEASE<span class="nt">&lt;/version&gt;</span>
       <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/dependencyManagement&gt;</span>

<span class="nt">&lt;build&gt;</span>
   <span class="nt">&lt;defaultGoal&gt;</span>spring-boot:run<span class="nt">&lt;/defaultGoal&gt;</span>
   ...
<span class="nt">&lt;/build&gt;</span>
</code></pre></div></div>

<p><strong>NOTE:</strong> The <code class="highlighter-rouge">defaultGoal</code> is optional, but it allows you to run <code class="highlighter-rouge">./mvnw</code> instead of <code class="highlighter-rouge">./mvnw spring-boot:run</code>. If you choose not to add it, please use <code class="highlighter-rouge">./mvnw spring-boot:run</code> wherever I use <code class="highlighter-rouge">./mvnw</code>.</p>

<h3 id="create-an-api-token">Create an API Token</h3>

<p>For the Okta Java SDK to talk to Okta’s API, you’ll need to <a href="https://developer.okta.com/docs/api/getting_started/getting_a_token">create an API token</a>. The abbreviated steps are as follows:</p>
<ol>
  <li>Log in to your Developer Console</li>
  <li>Navigate to <strong>API</strong> &gt; <strong>Tokens</strong> and click <strong>Create Token</strong></li>
  <li>Give your token a name, then copy its value</li>
</ol>

<p>Open <code class="highlighter-rouge">holdings-api/src/main/resources/application.properties</code> and add your API token as a property.</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">okta.client.token</span><span class="p">=</span><span class="s">XXX</span>
</code></pre></div></div>

<p>I’d recommend leaving <code class="highlighter-rouge">XXX</code> as the value in your properties file. The token’s value is not something you want to check into source control, but you want to make other developers aware of it. You can override this property on your machine by setting an <code class="highlighter-rouge">OKTA_CLIENT_TOKEN</code> environment variables. For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKTA_CLIENT_TOKEN</span><span class="o">=</span>&lt;real value you copied&gt;
</code></pre></div></div>

<p>While you’re editing <code class="highlighter-rouge">application.properties</code>, add properties for the issuer and client ID. You should have these from the last tutorial. If you didn’t complete it, you can create a new OIDC app in Okta using the step below.</p>

<ul>
  <li>Log in to your Okta account and navigate to <strong>Applications</strong> &gt; <strong>Add Application</strong></li>
  <li>Select <strong>SPA</strong> and click <strong>Next</strong></li>
  <li>Give your application a name (e.g. “Crypto PWA”)</li>
  <li>Add the following values for <strong>Base URI</strong> and <strong>Login redirect URI</strong>:
    <ul>
      <li><code class="highlighter-rouge">http://localhost:8100</code> (for development)</li>
      <li><code class="highlighter-rouge">https://&lt;name-of-your-choosing&gt;.firebaseapp.com</code> (for production)</li>
    </ul>
  </li>
  <li>Click <strong>Done</strong>.</li>
</ul>

<p>Copy the app’s <code class="highlighter-rouge">clientId</code> into <code class="highlighter-rouge">application.properties</code> and change <code class="highlighter-rouge">{yourOktaDomain}</code> to match your account. These properties will allow the client to pass an access token to the server and validate it.</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">okta.oauth2.issuer</span><span class="p">=</span><span class="s"><span class="okta-preview-domain"><span class="okta-preview-domain">https://{yourOktaDomain}.com</span></span>/oauth2/default</span>
<span class="py">okta.oauth2.clientId</span><span class="p">=</span><span class="s">{yourClientId}</span>
</code></pre></div></div>

<p><strong>NOTE:</strong> The values for <code class="highlighter-rouge">issuer</code> and <code class="highlighter-rouge">clientId</code> in <code class="highlighter-rouge">crypto-pwa/src/pages/login/login.ts</code> should match these values.</p>

<h3 id="enable-your-spring-boot-app-as-a-resource-server">Enable Your Spring Boot App as a Resource Server</h3>

<p>Configure your Spring Boot app to be a resource server and allow CORS requests by modifying its <code class="highlighter-rouge">HoldingsApiApplication.java</code> class.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">okta</span><span class="o">.</span><span class="na">developer</span><span class="o">.</span><span class="na">holdingsapi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.web.servlet.FilterRegistrationBean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.Ordered</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.cors.CorsConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.cors.UrlBasedCorsConfigurationSource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.filter.CorsFilter</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>

<span class="nd">@EnableResourceServer</span>
<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HoldingsApiApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">HoldingsApiApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">FilterRegistrationBean</span> <span class="nf">simpleCorsFilter</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">UrlBasedCorsConfigurationSource</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UrlBasedCorsConfigurationSource</span><span class="o">();</span>
        <span class="n">CorsConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CorsConfiguration</span><span class="o">();</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setAllowCredentials</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setAllowedOrigins</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="s">"*"</span><span class="o">));</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setAllowedMethods</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="s">"*"</span><span class="o">));</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setAllowedHeaders</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">singletonList</span><span class="o">(</span><span class="s">"*"</span><span class="o">));</span>
        <span class="n">source</span><span class="o">.</span><span class="na">registerCorsConfiguration</span><span class="o">(</span><span class="s">"/**"</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>
        <span class="n">FilterRegistrationBean</span> <span class="n">bean</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FilterRegistrationBean</span><span class="o">(</span><span class="k">new</span> <span class="n">CorsFilter</span><span class="o">(</span><span class="n">source</span><span class="o">));</span>
        <span class="n">bean</span><span class="o">.</span><span class="na">setOrder</span><span class="o">(</span><span class="n">Ordered</span><span class="o">.</span><span class="na">HIGHEST_PRECEDENCE</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="create-a-holdingscontroller-to-communicate-with-oktas-api">Create a HoldingsController to Communicate with Okta’s API</h3>

<p>Create a <code class="highlighter-rouge">HoldingsController.java</code> class in the same package as <code class="highlighter-rouge">HoldingsApiApplication</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">okta</span><span class="o">.</span><span class="na">developer</span><span class="o">.</span><span class="na">holdingsapi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.core.JsonProcessingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.core.type.TypeReference</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.okta.sdk.client.Client</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.okta.sdk.resource.user.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.Principal</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/holdings"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HoldingsController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">ObjectMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Client</span> <span class="n">client</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HOLDINGS_ATTRIBUTE_NAME</span> <span class="o">=</span> <span class="s">"holdings"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">HoldingsController</span><span class="o">(</span><span class="n">Client</span> <span class="n">client</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">client</span> <span class="o">=</span> <span class="n">client</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Holding</span><span class="o">&gt;</span> <span class="nf">getHoldings</span><span class="o">(</span><span class="n">Principal</span> <span class="n">principal</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getUser</span><span class="o">(</span><span class="n">principal</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>

        <span class="n">String</span> <span class="n">holdingsFromOkta</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">user</span><span class="o">.</span><span class="na">getProfile</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">HOLDINGS_ATTRIBUTE_NAME</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Holding</span><span class="o">&gt;</span> <span class="n">holdings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;&gt;();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">holdingsFromOkta</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">holdings</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">readValue</span><span class="o">(</span><span class="n">holdingsFromOkta</span><span class="o">,</span> <span class="k">new</span> <span class="n">TypeReference</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Holding</span><span class="o">&gt;&gt;()</span> <span class="o">{});</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">io</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error marshalling Okta custom data: "</span> <span class="o">+</span> <span class="n">io</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                <span class="n">io</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">holdings</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="n">Holding</span><span class="o">[]</span> <span class="nf">saveHoldings</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="n">Holding</span><span class="o">[]</span> <span class="n">holdings</span><span class="o">,</span> <span class="n">Principal</span> <span class="n">principal</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">getUser</span><span class="o">(</span><span class="n">principal</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">holdings</span><span class="o">);</span>
            <span class="n">user</span><span class="o">.</span><span class="na">getProfile</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="n">HOLDINGS_ATTRIBUTE_NAME</span><span class="o">,</span> <span class="n">json</span><span class="o">);</span>
            <span class="n">user</span><span class="o">.</span><span class="na">update</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JsonProcessingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error saving Okta custom data: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">holdings</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This class has a few things I’d like to point out:</p>

<ul>
  <li><code class="highlighter-rouge">com.okta.sdk.client.Client</code> is injected into the constructor by Spring and auto-configured with the API token</li>
  <li><code class="highlighter-rouge">client.getUser(principal.getName())</code> provides an easy way to get the <code class="highlighter-rouge">User</code> object</li>
  <li>Jackson’s <code class="highlighter-rouge">ObjectMapper</code> makes it easy to marshall the <code class="highlighter-rouge">Holding</code> object to and from JSON</li>
  <li>Retrieving user profile attributes is done with <code class="highlighter-rouge">user.getProfile().get(ATTRIBUTE_NAME)</code></li>
  <li>Saving user profile attributes is done with <code class="highlighter-rouge">user.getProfile().put(ATTRIBUTE_NAME)</code></li>
</ul>

<p><strong>NOTE:</strong> The call to <code class="highlighter-rouge">user.getProfile()</code> returns a <a href="https://developer.okta.com/okta-sdk-java/apidocs/com/okta/sdk/resource/user/UserProfile.html"><code class="highlighter-rouge">UserProfile</code></a>. This implements <code class="highlighter-rouge">java.util.Map</code> and <a href="https://developer.okta.com/okta-sdk-java/apidocs/com/okta/sdk/resource/PropertyRetriever.html"><code class="highlighter-rouge">PropertyRetriever</code></a>, which allows for more type-safe operations (<code class="highlighter-rouge">getString()</code>, <code class="highlighter-rouge">getBoolean()</code>, etc.).</p>

<p>Speaking of <code class="highlighter-rouge">Holding</code>, you’ll need to create a <code class="highlighter-rouge">com.okta.developer.holdingsapi.Holding</code> class to handle the values coming from (and sending to) the client.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">okta</span><span class="o">.</span><span class="na">developer</span><span class="o">.</span><span class="na">holdingsapi</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Holding</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">crypto</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">currency</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">amount</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCrypto</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">crypto</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCrypto</span><span class="o">(</span><span class="n">String</span> <span class="n">crypto</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">crypto</span> <span class="o">=</span> <span class="n">crypto</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCurrency</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">currency</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCurrency</span><span class="o">(</span><span class="n">String</span> <span class="n">currency</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">currency</span> <span class="o">=</span> <span class="n">currency</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getAmount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">amount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAmount</span><span class="o">(</span><span class="n">String</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">amount</span> <span class="o">=</span> <span class="n">amount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Holding{"</span> <span class="o">+</span>
                <span class="s">"crypto='"</span> <span class="o">+</span> <span class="n">crypto</span> <span class="o">+</span> <span class="sc">'\''</span> <span class="o">+</span>
                <span class="s">", currency='"</span> <span class="o">+</span> <span class="n">currency</span> <span class="o">+</span> <span class="sc">'\''</span> <span class="o">+</span>
                <span class="s">", amount='"</span> <span class="o">+</span> <span class="n">amount</span> <span class="o">+</span> <span class="sc">'\''</span> <span class="o">+</span>
                <span class="sc">'}'</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Congrats, you’ve done the hard work to create a Holdings API with Spring Boot! Now, modify the client to talk to this API instead of local storage.</p>

<h2 id="modify-the-crypto-pwa-client-to-store-holdings-in-okta">Modify the Crypto PWA Client to Store Holdings in Okta</h2>

<p>Below are the abbreviated changes you’ll need to make to <code class="highlighter-rouge">crypto-pwa/src/providers/holdings/holdings.ts</code> to talk to the API.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">HttpClient</span><span class="p">,</span> <span class="nx">HttpHeaders</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/common/http'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">OAuthService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'angular-oauth2-oidc'</span><span class="p">;</span>

<span class="p">...</span>
<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">HoldingsProvider</span> <span class="p">{</span>

  <span class="kr">public</span> <span class="nx">HOLDINGS_API</span> <span class="o">=</span> <span class="s1">'http://localhost:8080/api/holdings'</span><span class="p">;</span>
  <span class="p">...</span>
  
  <span class="kd">constructor</span><span class="p">(</span><span class="kr">private</span> <span class="nx">http</span><span class="p">:</span> <span class="nx">HttpClient</span><span class="p">,</span> <span class="kr">private</span> <span class="nx">oauthService</span><span class="p">:</span> <span class="nx">OAuthService</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
  
  <span class="p">...</span>
  
  <span class="nx">onError</span><span class="p">(</span><span class="nx">error</span><span class="p">):</span> <span class="k">void</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">'ERROR: '</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">getHeaders</span><span class="p">():</span> <span class="nx">HttpHeaders</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">HttpHeaders</span><span class="p">().</span><span class="kd">set</span><span class="p">(</span><span class="s1">'Authorization'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">oauthService</span><span class="p">.</span><span class="nx">authorizationHeader</span><span class="p">())</span>
  <span class="p">}</span>
  
  <span class="nx">saveHoldings</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">HOLDINGS_API</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">holdings</span><span class="p">,{</span><span class="na">headers</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHeaders</span><span class="p">()}).</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'holdings'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">onError</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="nx">loadHoldings</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">http</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">HOLDINGS_API</span><span class="p">,{</span><span class="na">headers</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHeaders</span><span class="p">()}).</span><span class="nx">subscribe</span><span class="p">((</span><span class="na">holdings</span><span class="p">:</span> <span class="nx">Holding</span><span class="p">[])</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">holdings</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">holdings</span> <span class="o">=</span> <span class="nx">holdings</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">fetchPrices</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">onError</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You’ll also want to remove the following line from the <code class="highlighter-rouge">fetchPrices()</code> method:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">saveHoldings</span><span class="p">();</span>
</code></pre></div></div>

<p>After making these changes, use a terminal to run <code class="highlighter-rouge">npm install &amp;&amp; ionic serve</code> in the <code class="highlighter-rouge">crypto-pwa</code> directory. Then open another terminal window and run <code class="highlighter-rouge">./mvnw</code> from the <code class="highlighter-rouge">holdings-api</code> directory.</p>

<p>Log in to the application at http://localhost:8100 and add a couple of holdings. For example, here’s what the Crypto PWA looks like after I added data:</p>

<p><img src="/assets/blog/cryptocurrency-pwa-java-sdk/holdings-in-okta-e10a3d76f75143ec09353f25b1b143b738f3252cd128463431bc5fac6bf586eb.png" alt="Holdings in Okta" width="800" class="center-image" /></p>

<p>Local storage can be handy because the data is cached locally and it’ll work offline. However, service workers cache network requests, so this application will work offline too. To prove it, toggle offline mode in Chrome’s Developer Tools &gt; Network &gt; Offline. Your holdings should still render when you refresh your browser.</p>

<p><img src="/assets/blog/cryptocurrency-pwa-java-sdk/holdings-in-okta-offline-a6910b2cecbbfede38dabe6e1810d82c2bf1d58f6952a6e597fd2ea57cbd81db.png" alt="Holdings in Okta - Offline" width="800" class="center-image" /></p>

<p>Even better, you can open another browser, e.g., Firefox, and retrieve your holdings by logging in. You can’t do that when using local storage!</p>

<p><img src="/assets/blog/cryptocurrency-pwa-java-sdk/crypto-pwa-in-firefox-8c7886ca7703060df6af66891bc9a4852c896a6fe797ebfb273687c390a4522f.png" alt="Works in Firefox!" width="800" class="center-image" /></p>

<h2 id="okta--java--️">Okta + Java = ❤️</h2>

<p>Okta loves Java and has a team of experts working on its Java SDK. The lead developer of the Java SDK is <a href="https://twitter.com/briandemers">Brian Demers</a>. Not only has he helped create the Spring Boot Starter and the Okta Java SDK, but he did most of the work to port the <a href="https://github.com/stormpath/stormpath-sdk-java">Stormpath Java SDK</a> to work with Okta.</p>

<p>You might remember the Stormpath Java SDK from my <a href="/blog/2017/08/08/secure-spring-microservices">Secure a Spring Microservices Architecture with Spring Security, JWTs, Juiser, and Okta</a>. I recently updated it to work with the latest releases of its libraries, so check it out if you get a chance!</p>

<p>To learn more about Okta’s Java support, you can review the following documentation:</p>

<ul>
  <li><a href="https://developer.okta.com/okta-sdk-java/apidocs/">Okta Java SDK Javadocs</a></li>
  <li><a href="https://github.com/okta/okta-sdk-java">Okta Java SDK on GitHub</a></li>
  <li><a href="https://github.com/okta/okta-spring-boot">Okta Spring Boot Starter</a></li>
</ul>

<p>I think you’ll find the following blog posts useful too!</p>

<ul>
  <li><a href="/blog/2017/11/20/add-sso-spring-boot-15-min">Add Single Sign-On to Your Spring Boot Web App in 15 Minutes</a></li>
  <li><a href="/blog/2017/10/27/secure-spa-spring-boot-oauth">Secure your SPA with Spring Boot and OAuth</a></li>
  <li><a href="/blog/2017/10/13/okta-groups-spring-security">Add Role-Based Access Control to Your App with Spring Security and Thymeleaf</a></li>
</ul>

<p>If you love Java too, <a href="https://twitter.com/oktadev">follow @oktadev</a> on Twitter and let us know if you have any issues with this tutorial. You can also post your questions to the <a href="https://devforum.okta.com/">Okta Developer Forums</a> or simply leave a comment on this post.</p>


    </div>

    
    <div id="disqus">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_title = 'Use Okta (Instead of Local Storage) to Store Your User’s Data Securely';
            var disqus_url = 'https://developer.okta.com/blog/2018/01/23/replace-local-storage-with-okta-profile-attributes';

            (function () {
                var dsq = document.createElement('script');
                dsq.async = true;
                dsq.type = 'text/javascript';
                dsq.src = '//oktadevblog.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
          <noscript>
              Please enable JavaScript to view the
              <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus</a>.
         </noscript>
    </div>
    
</article>

		
</section>

		
	</div>
	<footer class="Footer">
    <div class="Wrap">

        <div class="Row">

            <div class="Column--3 Column--medium-6 Column--xSmall-12">
                <a href="https://www.okta.com/" target="_blank" rel="noopener noreferrer">
                    <div class="Logo">
                        <img src="https://developer.okta.com/sites/all/themes/developer/images/logo-footer.png" alt="Okta">
                    </div>
                    <p>Visit okta.com</p>
                </a>
            </div>

            <div class="Column--3 Column--medium-12 Column--xSmall-12">
                <h4>Social</h4>
                <ul class="Footer-links Footer-links--social">
                    <li><a class="Footer-links--github" target="_blank" rel="noopener noreferrer" href="http://github.com/oktadeveloper">Github</a></li>
                    <li><a class="Footer-links--twitter" target="_blank" rel="noopener noreferrer" href="http://twitter.com/OktaDev">Twitter</a></li>
                    <li><a class="Footer-links--forum" target="_blank" rel="noopener noreferrer" href="https://devforum.okta.com/">Forum</a></li>
                    <li><a class="Footer-links--rss" target="_blank" rel="noopener noreferrer" href="http://feeds.feedburner.com/OktaBlog">RSS Blog</a></li>
                </ul>
            </div>

            <div class="Column--3 Column--medium-6 Column--small-12">
                <h4>More Info</h4>
                <ul class="Footer-links">
                    <li><a target="_blank" href="https://developer.okta.com/integrate-with-okta/">Integrate with Okta</a></li>
                    <li><a href="/blog/">Blog</a></li>
                    <li><a href="/docs/change-log/">Change Log</a></li>
                    <li><a href="/3rd_party_notices/">3rd Party Notices</a></li>
                </ul>
            </div>

            <div class="Column--3 Column--medium-6 Column--small-12">
                <h4>Contact &amp; Legal</h4>
                <ul class="Footer-links">
                    <li><a href="https://developer.okta.com/contact/">Contact Sales</a></li>
                    <li><a target="_blank" rel="noopener noreferrer" href="mailto:developers@okta.com">Contact Support</a></li>
                    <li><a href="https://developer.okta.com/terms/">Terms &amp; Conditions</a></li>
                    <li><a href="https://developer.okta.com/privacy/">Privacy Policy</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script type="text/javascript" src="/assets/master-aa397c892d9083236c5cb20732dde679021b9236c8142ce78177b8b184567a02.js"></script>
    <script type="text/javascript" src="/assets/myOkta-911cbafbbe079b7a5522d9cbe15bd2a5f44e1582531e88393934bec69f97696b.js"></script>
    
    
    
    
      <script type="text/javascript" src="/assets/blog-6e32dad27404131cc8630a5282264bed2ab4c08c91ac86fa496b75c53aa4f681.js"></script>
    

  <!-- START Post Footer -->
  
  <!-- START Google Tag Manager -->
  <!-- https://support.google.com/tagmanager/answer/6103696?hl=en -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- END Google Tag Manager -->
  <!-- START Google Remarketing Tag -->
  <script type="text/javascript">
    /* <![CDATA[ */
    var google_conversion_id = 1006913831;
    var google_custom_params = window.google_tag_params;
    var google_remarketing_only = true;
    /* ]]> */
  </script>
  <div style="display:none;"><script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script></div>
  <noscript><div style="display:inline;"><img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1006913831/?value=0&amp;guid=ON&amp;script=0"></div></noscript>
  <!-- END Google Remarketing Tag -->
  <!-- START Crazy Egg Tracking -->
  <script type="text/javascript">
    setTimeout(function(){var a=document.createElement("script");
    var b=document.getElementsByTagName("script")[0];
    a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0021/9333.js?"+Math.floor(new Date().getTime()/3600000);
    a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>
  <!-- END Crazy Egg Tracking -->

  <!-- END Post Footer -->
</body>
</html>
