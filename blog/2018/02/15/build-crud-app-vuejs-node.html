<!doctype html>
<!--[if lt IE 7 ]> <html class="ie6 no-flexbox"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7 no-flexbox"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8 no-flexbox"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie9 no-flexbox"> <![endif]-->
<!--[if IE 10 ]>    <html class="ie10 no-flexbox"> <![endif]-->
<!--[if (gt IE 10)|!(IE)]><!--> <html class="modern wf-loading" lang="en"> <!--<![endif]-->
  <head>
  <script>
    var searchDomain = 'https://developer.okta.com';
    var isProduction = window.location.hostname === 'developer.okta.com';
    if (isProduction) {
      // TypeKit
      (function(d) {
        var config = {
          kitId: 'jff5neq',
          scriptTimeout: 3000,
          async: true
        },
        h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/bwf-loadingb/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
      })(document);

      // Google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-15777010-3', 'auto');
      ga('send', 'pageview');

      // START Google Tag Manager
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-TJ45R6');
      // END Google Tag Manager
    }
  </script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   

  <link type="text/css" rel="stylesheet" href="https://developer.okta.com/sites/all/themes/developer/css/master.css" media="all" />
  <meta class="swiftype" name="title" data-type="string" content="Build a Basic CRUD App with Vue.js and Node | Okta Developer">
  <meta class="swiftype" name="summary" data-type="string" content="This post shows you how to use build a basic CRUD application with Vue.js and Node. You'll also learn how to use Okta's Vue SDK to add authentication using OIDC." />

  <link type="text/css" rel="stylesheet" href="/assets/animate-ec43d72c3ed45e08a460b8a2966d8dba6006aebfa0530935c3973fa493a8771f.css">
  <link type="text/css" rel="stylesheet" href="/assets/okta-943074870de1efc80ec41db55bc8633148bcc085ddebad595e019ddc461dca51.css">
  
  
  <title>Build a Basic CRUD App with Vue.js and Node | Okta Developer</title>
  <meta name="description" content="This post shows you how to use build a basic CRUD application with Vue.js and Node. You'll also learn how to use Okta's Vue SDK to add authentication using OIDC.">
  <link rel="alternate" type="application/rss+xml" title="Okta Developer" href="https://developer.okta.com/feed.xml"><!-- GA -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
  <link rel="manifest" href="/assets/favicon/manifest.json">
  <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#21313a">
  <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
</head>

  
    <body id="blog">
	




<header class="Header is-fixed">

  <div class="Wrap">

    <a class="Logo" href="https://developer.okta.com">
      <svg version="1.1" id="OktaLogo" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 431.9 151.4" style="enable-background:new 0 0 431.9 151.4;" xml:space="preserve"><g><g><g><path d="M102.2,41.4c-21,0-38.1,17.1-38.1,38.1s17.1,38.1,38.1,38.1s38.1-17.1,38.1-38.1l0,0C140.3,58.5,123.2,41.4,102.2,41.4z M102.2,98.5c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19c0.1,10.5-8.4,19-18.9,19.1C102.3,98.6,102.2,98.6,102.2,98.5L102.2,98.5z"/><path d="M169.1,92.3c0-1.9,1.5-3.4,3.4-3.4c0.9,0,1.8,0.4,2.4,1c9.5,9.7,25.3,26.3,25.4,26.4c0.4,0.5,0.8,0.8,1.4,0.9l1.6,0.2h17.2c1.8,0,3.3-1.4,3.4-3.2c0-0.8-0.3-1.5-0.8-2.2l-28.6-29.2l-1.5-1.5c-3.2-3.9-2.9-5.4,0.8-9.3l22.6-25.1c1.1-1.4,0.8-3.5-0.6-4.6c-0.6-0.4-1.3-0.7-2-0.7h-17c-0.6,0.2-1.1,0.5-1.5,0.9L175,64.4c-1.3,1.4-3.4,1.5-4.8,0.2c-0.7-0.6-1.1-1.5-1.1-2.5V18.9c0-1.7-1.3-3-3-3c-0.1,0-0.2,0-0.3,0h-12.7c-2.2,0-3.3,1.5-3.3,2.8v95.8c0,2.2,1.8,2.8,3.3,2.8h12.7c1.7,0.1,3.2-1.2,3.3-2.9c0,0,0,0,0,0V92.3z"/><path d="M273,114l-1.4-12.8c-0.2-1.7-1.7-2.9-3.4-2.7c0,0,0,0-0.1,0l-2.9,0.2c-10.1,0-18.5-7.9-19-18c0-0.3,0-0.7,0-1V64.2c-0.1-2,1.5-3.6,3.5-3.7c0,0,0,0,0,0h17c1.7-0.1,3.1-1.5,3-3.2c0,0,0-0.1,0-0.1v-12c0-2.3-1.5-3.6-2.8-3.6h-17.1c-1.9,0.1-3.5-1.5-3.6-3.4c0,0,0,0,0,0V18.9c-0.1-1.7-1.5-3.1-3.2-3c0,0-0.1,0-0.1,0h-12.7c-1.6-0.1-3,1.1-3.1,2.7c0,0.1,0,0.1,0,0.2c0,0,0,61.7,0,62c0.5,21,17.9,37.6,38.9,37c1.4,0,2.9-0.2,4.3-0.3C272,117.2,273.2,115.7,273,114z"/></g><path d="M364.7,98c-10.8,0-12.4-3.8-12.4-18.3l0,0V44.8c0-1.8-1.4-3.2-3.2-3.2c0,0-0.1,0-0.1,0h-12.8c-1.8,0-3.2,1.4-3.3,3.2v1.6C314.6,36,291.3,42.5,281,60.8c-10.4,18.3-3.9,41.6,14.4,51.9c14,7.9,31.4,6.2,43.5-4.2c3.6,5.5,9.3,9.1,18.3,9.1c1.5,0,9.7,0.3,9.7-3.5v-13.6C367,99.2,366,98.1,364.7,98z M314.2,98.6c-10.5,0-19-8.5-19-19s8.5-19,19-19s19,8.5,19,19l0,0C333.2,90.1,324.7,98.6,314.2,98.6z"/></g><path d="M19.4,74c2.2-1.9,4.1-4.1,5.7-6.6c3.5-5.3,5.4-11.5,5.2-17.9V27c0-4.9,0.9-8.4,2.7-10.5c1.8-2.1,4.8-3,9.2-3h12.6c1.2,0,2.1-0.9,2.2-2.1l0,0V2.2C57,1,56,0,54.8,0c0,0,0,0,0,0H41.5c-7.8,0-12.9,2.1-18,7.6s-7.1,12.3-7.1,21.7v14.2c0,2.2-0.1,4-0.2,5.7v2.2c-0.5,3.2-1.8,6.2-3.6,8.9C9.4,64.7,5.1,70.9,0.9,74l0,0l-0.3,0.3l0,0l-0.2,0.3H0.2v0.3l0,0c-0.1,0.3-0.1,0.7,0,1l0,0v0.3h0.1l0.2,0.3l0,0l0.3,0.3l0,0c4.2,3.1,8.5,9.3,11.3,13.7c1.8,2.7,3.1,5.7,3.6,8.9v2.2c0.1,1.6,0.2,3.5,0.2,5.7v14.3c0,9.4,2.4,16.7,7.1,21.7s10.2,7.6,18,7.6h13.8c1.2,0,2.2-1,2.2-2.2V140l0,0c0-1.2-1-2.2-2.2-2.2H42.2c-4.4,0-7.5-1-9.2-3s-2.7-5.6-2.7-10.5v-22.4c0.2-6.4-1.7-12.6-5.2-17.9c-1.6-2.5-3.5-4.7-5.7-6.6l0,0c-0.9-0.7-1.1-2-0.4-2.9C19.2,74.3,19.3,74.2,19.4,74L19.4,74z"/><path d="M412.5,74c-2.2-1.9-4.1-4.1-5.7-6.6c-3.5-5.3-5.4-11.5-5.2-17.9V27c0-4.9-0.9-8.4-2.7-10.5s-4.8-3-9.2-3h-12.6c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0l0,0V2.2c0-1.2,1-2.2,2.2-2.2c0,0,0,0,0,0h13.4c7.8,0,12.9,2.1,18,7.6s7.1,12.3,7.1,21.7v14.2c0,2.2,0.1,4,0.2,5.7v2.2c0.5,3.2,1.8,6.2,3.6,8.9c2.8,4.5,7.1,10.7,11.3,13.7l0,0l0.3,0.3l0,0l0.2,0.3h0.1v0.3l0,0c0.1,0.3,0.1,0.7,0,1l0,0v0.3h-0.1l-0.2,0.3l0,0l-0.3,0.3l0,0c-4.2,3.1-8.5,9.3-11.3,13.7c-1.8,2.7-3.1,5.7-3.6,8.9v2.2c-0.1,1.6-0.2,3.5-0.2,5.7v14.3c0,9.4-2.4,16.7-7.1,21.7s-10.2,7.6-18,7.6h-13.4c-1.2,0-2.2-1-2.2-2.2c0,0,0,0,0,0V140l0,0c0-1.2,1-2.2,2.2-2.2l0,0h12.7c4.4,0,7.5-1,9.2-3s2.7-5.6,2.7-10.5v-22.4c-0.2-6.3,1.6-12.6,5.1-17.9c1.6-2.5,3.5-4.7,5.7-6.6l0,0c0.9-0.7,1.1-2,0.4-2.9C412.7,74.3,412.6,74.2,412.5,74L412.5,74z"/></g></svg>
    </a>

    <nav class="Header-nav PrimaryNav">
      <ul class="menu">
        <li class="first expanded">
          <a href="https://developer.okta.com/product/">Product</a>
          <ul class="menu">
            <li class="first leaf"><a href="https://developer.okta.com/product/">Overview</a></li>
            <li class="leaf"><a href="https://developer.okta.com/product/authentication/">Authentication</a></li>
            <li class="leaf"><a href="https://developer.okta.com/product/authorization/">Authorization</a></li>
            <li class="last leaf"><a href="https://developer.okta.com/product/user-management/">User Management</a></li>
          </ul>
        </li>
        <li class="leaf">
          <a href="https://developer.okta.com/pricing/">Pricing</a>
        </li>
        <li class="leaf">
          <a href="/blog/" class="active">Blog</a>
        </li>
        <li class="leaf">
          <a href="/documentation/">Docs</a>
        </li>
        <li class="last expanded">
          <span class="nolink">Support</span>
          <ul class="menu">
            <li class="first leaf"><a href="https://devforum.okta.com/">Okta Developer Forums</a></li>
            <li class="last leaf"><a href="mailto:developers@okta.com">developers@okta.com</a></li>
          </ul>
        </li>
      </ul>
      <a class="PrimaryNav-toggle" href="#">
        <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g class="MenuIcon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
                <path d="M1,16 L19,16" class="MenuIcon-line1" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,4 L19,4" class="MenuIcon-line2" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,10 L19,10" class="MenuIcon-line3" stroke="#FFFFFF" stroke-width="2"></path>
                <path d="M1,10 L19,10" class="MenuIcon-line4" stroke="#FFFFFF" stroke-width="2"></path>
            </g>
        </svg>
        <svg class="CloseIcon" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="ALl-Boards" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="Desktop" transform="translate(-915.000000, -235.000000)" fill="#FFFFFF">
              <g id="Search-bar-Active" transform="translate(30.000000, 26.000000)">
                <polygon id="Icon/Cross" points="901 210.6 899.4 209 893 215.4 886.6 209 885 210.6 891.4 217 885 223.4 886.6 225 893 218.6 899.4 225 901 223.4 894.6 217"></polygon>
              </g>
            </g>
          </g>
        </svg>
      </a>

      <div class="PrimaryNav-cta">
        <a target="_blank" rel="noopener noreferrer" href="https://login.okta.com/?SAMLRequest=fc%2B7CsJAEAXQXvAflu1NNJUMeZBGELTx1a%2FrYILJTtyZGD%2FfSBRiYzlw77lMnD3rSj3Qc0ku0YtgrhU6S5fSXRN9PKxmS52l00nMpq6iBvJWCrfDe4ss6vStRe9aDzmGIZfo1jsgwyWDMzUyiIV9vt1AH4XGk5ClSvewUgMNa%2BYW%2FVj5jxhm9NLP67QQaSAMu64L6CYmsFSHlnzT4ZlLwTgcL6Sf8%2FeX9AU%3Dhttps://login.okta.com/?SAMLRequest=fc%2B7CsJAEAXQXvAflu1NNJUMeZBGELTx1a%2FrYILJTtyZGD%2FfSBRiYzlw77lMnD3rSj3Qc0ku0YtgrhU6S5fSXRN9PKxmS52l00nMpq6iBvJWCrfDe4ss6vStRe9aDzmGIZfo1jsgwyWDMzUyiIV9vt1AH4XGk5ClSvewUgMNa%2BYW%2FVj5jxhm9NLP67QQaSAMu64L6CYmsFSHlnzT4ZlLwTgcL6Sf8%2FeX9AU%3D" class="Button--redOutline">Login</a>
        <a href="https://developer.okta.com/signup/" class="Button--red">Sign up</a>
      </div>

      <a class="SearchIcon" href="#"></a>
      <form id="form_search" class="SearchBar Formisimo_clocked_69929" method="get" action="https://developer.okta.com/search/" name="form_search" __bizdiag="-784164280" __biza="WJ__">
        <input type="text" name="stq" autocomplete="off" id="st-search-input-auto" class="st-search-input" placeholder="Search">
        <input type="submit" name="submit" value="GO">
      </form>

    </nav>

  </div>

</header>

	<div class="page-content">
		






<section class="Blog is-single">
		
	<div class="Blog-social">
		
		<a href="https://github.com/bparise" target="_blank"><i class="fa fa-github"></i></a>
		
		
		
		
		<a href="https://modernup.io/" target="_blank"><i class="fa fa-external-link"></i></a>
		
	</div>
	
	

<article class="BlogPost">

    <header class="BlogPost-header">

        <time class="BlogPost-date" datetime="2018-02-15">February 15, 2018</time>

        <h1 class="BlogPost-title">
            
            Build a Basic CRUD App with Vue.js and Node
            
        </h1>

        <div class="BlogPost-attribution">
            
            <img src="/assets/avatar-brandon_parise-2ba523e3b9415f989d311c0f48f88ec87954676c0f534dce1248fb2ea55b7584.jpg" alt="avatar-brandon_parise.jpg" class="BlogPost-avatar">
            
            <span class="BlogPost-author">Brandon Parise</span>
        </div>

    </header>

    <div class="BlogPost-content">
        
	<p>I’ve danced the JavaScript framework shuffle for years starting with jQuery, then on to Angular. After being frustrated with Angular’s complexity, I found React and thought I was in the clear. What seemed simple on the surface ended up being a frustrating mess. Then I found Vue.js.  It just felt right. It worked as expected. It was fast. The documentation was incredible. Templating was eloquent. There was a unanimous consensus around how to handle state management, conditional rendering, two-way binding, routing, and more.</p>

<p>This tutorial will take you step by step through scaffolding a Vue.js project, offloading secure authentication to <a href="/docs/api/resources/oidc">Okta’s OpenID Connect API (OIDC)</a>, locking down protected routes, and performing CRUD operations through a backend REST API server. This tutorial uses the following technologies but doesn’t require intimate knowledge to follow along:</p>

<ul>
  <li>Vue.js with <a href="https://github.com/vuejs/vue-cli">vue-cli</a>, <a href="https://github.com/vuejs/vue-router">vue-router</a>, and <a href="https://github.com/okta/okta-oidc-js/tree/master/packages/okta-vue">Okta Vue SDK</a></li>
  <li>Node with <a href="https://github.com/expressjs/express">Express</a>, <a href="https://github.com/okta/okta-auth-js">Okta JWT Verifier</a>, <a href="https://github.com/sequelize/sequelize">Sequelize</a>, and <a href="https://github.com/dchester/epilogue">Epiloge</a></li>
</ul>

<h2 id="about-vuejs">About Vue.js</h2>

<p>Vue.js is a robust but simple Javascript framework. It has one of the lowest barriers to entry of any modern framework while providing all the required features for high performance web applications.</p>

<p><img src="/assets/blog/vue-crud-node/vue-homepage-8a8c67ceb95ba55306607a4cd4fd0a1d1a3821ab6f9facd7024e2ed1d806c714.png" alt="Vue.js Homepage" width="800" class="center-image" /></p>

<p>This tutorial covers two primary builds, a frontend web app and backend REST API server. The frontend will be a single page application (SPA) with a homepage, login and logout, and a posts manager.</p>

<p><a href="/docs/api/resources/oidc">Okta’s OpenID Connect (OIDC)</a> will handle our web app’s authentication through the use of <a href="https://github.com/okta/okta-oidc-js/tree/master/packages/okta-vue">Okta’s Vue SDK</a>. If an unauthenticated user navigates to the posts manager, the web app should attempt to authenticate the user.</p>

<p>The server will run <a href="https://www.express.com/">Express</a> with <a href="http://docs.sequelizejs.com/">Sequelize</a> and <a href="https://github.com/dchester/epilogue">Epilogue</a>. At a high level, with Sequelize and Epilogue you can quickly generate dynamic REST endpoints with just a few lines of code.</p>

<p>You will use JWT-based authentication when making requests from the web app and <a href="https://github.com/okta/okta-oidc-js/tree/master/packages/jwt-verifier">Okta’s JWT Verifier</a> in an Express middleware to validate the token. Your app will expose the following endpoints which all require requests to have a valid access token.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- GET /posts
- GET /posts/:id
- POST /posts
- PUT /posts/:id
- DELETE /posts/:id
</code></pre></div></div>

<h2 id="create-your-vuejs-app">Create Your Vue.js App</h2>

<p>To get your project off the ground quickly you can leverage the scaffolding functionality from <a href="https://github.com/vuejs/vue-cli">vue-cli</a>. For this tutorial, you are going to use the <a href="https://github.com/vuejs-templates/pwa">progressive web app (PWA) template</a> that includes a handful of features including <a href="https://github.com/webpack/webpack">webpack</a>, <a href="https://vue-loader.vuejs.org/en/features/hot-reload">hot reloading</a>, CSS extraction, and unit testing.</p>

<blockquote>
  <p>If you’re not familiar with the tenets of PWA, check out our <a href="/blog/2017/07/20/the-ultimate-guide-to-progressive-web-applications">ultimate guide to progressive web applications</a>.</p>
</blockquote>

<p>To install <code class="highlighter-rouge">vue-cli</code> run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install -g vue-cli
</code></pre></div></div>

<p>Next, you need to initialize your project.  When you run the <code class="highlighter-rouge">vue init</code> command just accept all the default values.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vue init pwa my-vue-app
cd ./my-vue-app
npm install
npm run dev
</code></pre></div></div>

<p>Point your favorite browser to <code class="highlighter-rouge">http://localhost:8080</code> and you should see the fruits of your labor:</p>

<p><img src="/assets/blog/vue-crud-node/welcome-to-vue-pwa-eea589caa41609323c8793291ebd75f19e9e9139b9165a077005118577def59e.png" alt="Welcome to Your Vue.js PWA" width="800" class="center-image" /></p>

<p><strong>Extra Credit</strong>: Check out the other <a href="https://github.com/vuejs-templates">templates</a> available for <code class="highlighter-rouge">vue-cli</code>.</p>

<h2 id="install-bootstrap">Install Bootstrap</h2>
<p>Let’s install <a href="https://github.com/bootstrap-vue/bootstrap-vue">bootstrap-vue</a> so you can take advantage of the various premade <a href="https://getbootstrap.com/docs/4.0/components/">components</a> (plus you can keep the focus on functionality and not on custom CSS):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm i --save bootstrap-vue bootstrap@4.0.0-beta.2
</code></pre></div></div>

<p>To complete the installation, modify <code class="highlighter-rouge">./src/main.js</code> to include <a href="https://github.com/bootstrap-vue/bootstrap-vue">bootstrap-vue</a> and import the required CSS files. Your <code class="highlighter-rouge">./src/main.js</code> file should look like this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// The Vue build version to load with the `import` command</span>
<span class="c1">// (runtime-only or standalone) has been set in webpack.base.conf with an alias.</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="s1">'vue'</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="s1">'./App'</span>
<span class="k">import</span> <span class="nx">router</span> <span class="k">from</span> <span class="s1">'./router'</span>
<span class="k">import</span> <span class="nx">BootstrapVue</span> <span class="k">from</span> <span class="s1">'bootstrap-vue'</span>
<span class="k">import</span> <span class="s1">'bootstrap/dist/css/bootstrap.css'</span>
<span class="k">import</span> <span class="s1">'bootstrap-vue/dist/bootstrap-vue.css'</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">BootstrapVue</span><span class="p">)</span>
<span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">productionTip</span> <span class="o">=</span> <span class="kc">false</span>

<span class="cm">/* eslint-disable no-new */</span>
<span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
  <span class="na">el</span><span class="p">:</span> <span class="s1">'#app'</span><span class="p">,</span>
  <span class="nx">router</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;App/&gt;'</span><span class="p">,</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span> <span class="nx">App</span> <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="add-authentication-with-okta">Add Authentication with Okta</h2>

<p>Dealing with authentication in a web app is the bane of every developer’s existence. That’s where Okta comes in to secure your web applications with minimal code. To get started, you will need to create an OIDC application in Okta. <a href="https://developer.okta.com/signup/">Sign up for a forever-free developer account</a> (or log in if you already have one).</p>

<p><img src="/assets/blog/vue-crud-node/okta-developer-sign-up-8076b22d5d523a70c1c8a0cef34993103f3a2d01d821d2cc31a1f3ba9798cb08.png" alt="Okta Developer Sign Up" width="800" class="center-image" /></p>

<p>Once logged in, create a new application by clicking “Add Application”.</p>

<p><img src="/assets/blog/vue-crud-node/add-application-024fdfa427033e2e345b48167d8fdef2592f8dcaa464be89487e257a629d39ad.png" alt="Add Application" width="800" class="center-image" /></p>

<p>Select the “Single-Page App” platform option.</p>

<p><img src="/assets/blog/vue-crud-node/new-application-options-96b1b0faa43717d47faaf99696fe2155e793c5f482b7cbae21747bdf3fd72ba4.png" alt="New Application Options" width="800" class="center-image" /></p>

<p>The default application settings should be the same as those pictured.</p>

<p><img src="/assets/blog/vue-crud-node/okta-application-settings-99892ff83b5e572a4c2b64d3d9b2edde2266d7f7434c18b8e60f6f005d7718e0.png" alt="Okta Application Settings" width="800" class="center-image" /></p>

<p>To install the Okta Vue SDK, run the following command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm i --save @okta/okta-vue
</code></pre></div></div>

<p>Open <code class="highlighter-rouge">./src/router/index.js</code> and replace the entire file with the following code.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="s1">'vue'</span>
<span class="k">import</span> <span class="nx">Router</span> <span class="k">from</span> <span class="s1">'vue-router'</span>
<span class="k">import</span> <span class="nx">Hello</span> <span class="k">from</span> <span class="s1">'@/components/Hello'</span>
<span class="k">import</span> <span class="nx">PostsManager</span> <span class="k">from</span> <span class="s1">'@/components/PostsManager'</span>
<span class="k">import</span> <span class="nx">Auth</span> <span class="k">from</span> <span class="s1">'@okta/okta-vue'</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Auth</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">issuer</span><span class="p">:</span> <span class="s1">'<span class="okta-preview-domain"><span class="okta-preview-domain">https://{yourOktaDomain}.com</span></span>/oauth2/default'</span><span class="p">,</span>
  <span class="na">client_id</span><span class="p">:</span> <span class="s1">'{yourClientId}'</span><span class="p">,</span>
  <span class="na">redirect_uri</span><span class="p">:</span> <span class="s1">'http://localhost:8080/implicit/callback'</span><span class="p">,</span>
  <span class="na">scope</span><span class="p">:</span> <span class="s1">'openid profile email'</span>
<span class="p">})</span>

<span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Router</span><span class="p">)</span>

<span class="kd">let</span> <span class="nx">router</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Router</span><span class="p">({</span>
  <span class="na">mode</span><span class="p">:</span> <span class="s1">'history'</span><span class="p">,</span>
  <span class="na">routes</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">path</span><span class="p">:</span> <span class="s1">'/'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'Hello'</span><span class="p">,</span>
      <span class="na">component</span><span class="p">:</span> <span class="nx">Hello</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">path</span><span class="p">:</span> <span class="s1">'/implicit/callback'</span><span class="p">,</span>
      <span class="na">component</span><span class="p">:</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">handleCallback</span><span class="p">()</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">path</span><span class="p">:</span> <span class="s1">'/posts-manager'</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="s1">'PostsManager'</span><span class="p">,</span>
      <span class="na">component</span><span class="p">:</span> <span class="nx">PostsManager</span><span class="p">,</span>
      <span class="na">meta</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">requiresAuth</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">})</span>

<span class="nx">router</span><span class="p">.</span><span class="nx">beforeEach</span><span class="p">(</span><span class="nx">Vue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">authRedirectGuard</span><span class="p">())</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">router</span>
</code></pre></div></div>

<p>You’ll need to replace <code class="highlighter-rouge">{yourOktaDomain}</code> and <code class="highlighter-rouge">{yourClientId}</code> which can be found on your application overview page in the Okta Developer Console. This will inject an <code class="highlighter-rouge">authClient</code> object into your Vue instance which can be accessed by calling <code class="highlighter-rouge">this.$auth</code> anywhere inside your Vue instance.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Vue</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">Auth</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">issuer</span><span class="p">:</span> <span class="s1">'<span class="okta-preview-domain"><span class="okta-preview-domain">https://{yourOktaDomain}.com</span></span>/oauth2/default'</span><span class="p">,</span>
  <span class="na">client_id</span><span class="p">:</span> <span class="s1">'{yourClientId}'</span><span class="p">,</span>
  <span class="na">redirect_uri</span><span class="p">:</span> <span class="s1">'http://localhost:8080/implicit/callback'</span><span class="p">,</span>
  <span class="na">scope</span><span class="p">:</span> <span class="s1">'openid profile email'</span>
<span class="p">})</span>
</code></pre></div></div>

<p>The final step of Okta’s authentication flow is redirecting the user back to your app with the token values in the URL. The <code class="highlighter-rouge">Auth.handleCallback()</code> component included in the SDK handles the redirect and persists the tokens on the browser.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">path</span><span class="p">:</span> <span class="s1">'/implicit/callback'</span><span class="p">,</span>
  <span class="nx">component</span><span class="p">:</span> <span class="nx">Auth</span><span class="p">.</span><span class="nx">handleCallback</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You also need to lock down protected routes from being access by unauthenticated users. This is accomplished by implementing a <a href="https://router.vuejs.org/en/advanced/navigation-guards">navigation guard</a>. As the name suggests, <a href="https://router.vuejs.org/en/advanced/navigation-guards">navigation guards</a> are primarily used to guard navigations either by redirecting or canceling.</p>

<p>The SDK comes with the method <code class="highlighter-rouge">auth.authRedirectGuard()</code> that checks matched routes’ metadata for the key <code class="highlighter-rouge">requiresAuth</code> and redirects the user to the authentication flow if they are not authenticated.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">router</span><span class="p">.</span><span class="nx">beforeEach</span><span class="p">(</span><span class="nx">Vue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">authRedirectGuard</span><span class="p">())</span>
</code></pre></div></div>

<p>With this navigation guard installed, any route that has the following metadata will be protected.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">meta</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">requiresAuth</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="customize-your-app-layout-in-vue">Customize Your App Layout in Vue</h2>
<p>The web app’s layout is located in a component <code class="highlighter-rouge">./src/App.vue</code>.  You can use the <a href="https://router.vuejs.org/en/api/router-view">router-view</a> component to render the matched component for the given path.</p>

<p>For the main menu, you’ll want to change the visibility of certain menu items based on the status of the <code class="highlighter-rouge">activeUser</code>:</p>

<ul>
  <li>Not Authenticated: Show only <em>Login</em></li>
  <li>Authenticated: Show only <em>Logout</em></li>
</ul>

<p>You can toggle the visibility of these menu items using the <code class="highlighter-rouge">v-if</code> directive in Vue.js that checks the existence of <code class="highlighter-rouge">activeUser</code> on the component.  When the component is loaded (which calls <code class="highlighter-rouge">created()</code>) or when a route changes we want to refresh the <code class="highlighter-rouge">activeUser</code>.</p>

<p>Open <code class="highlighter-rouge">./src/App.vue</code> and copy/paste the following code.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;b-navbar</span> <span class="na">toggleable=</span><span class="s">"md"</span> <span class="na">type=</span><span class="s">"dark"</span> <span class="na">variant=</span><span class="s">"dark"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;b-navbar-toggle</span> <span class="na">target=</span><span class="s">"nav_collapse"</span><span class="nt">&gt;&lt;/b-navbar-toggle&gt;</span>
      <span class="nt">&lt;b-navbar-brand</span> <span class="na">to=</span><span class="s">"/"</span><span class="nt">&gt;</span>My Vue App<span class="nt">&lt;/b-navbar-brand&gt;</span>
      <span class="nt">&lt;b-collapse</span> <span class="na">is-nav</span> <span class="na">id=</span><span class="s">"nav_collapse"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;b-navbar-nav&gt;</span>
          <span class="nt">&lt;b-nav-item</span> <span class="na">to=</span><span class="s">"/"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/b-nav-item&gt;</span>
          <span class="nt">&lt;b-nav-item</span> <span class="na">to=</span><span class="s">"/posts-manager"</span><span class="nt">&gt;</span>Posts Manager<span class="nt">&lt;/b-nav-item&gt;</span>
          <span class="nt">&lt;b-nav-item</span> <span class="na">href=</span><span class="s">"#"</span> <span class="err">@</span><span class="na">click</span><span class="err">.</span><span class="na">prevent=</span><span class="s">"login"</span> <span class="na">v-if=</span><span class="s">"!activeUser"</span><span class="nt">&gt;</span>Login<span class="nt">&lt;/b-nav-item&gt;</span>
          <span class="nt">&lt;b-nav-item</span> <span class="na">href=</span><span class="s">"#"</span> <span class="err">@</span><span class="na">click</span><span class="err">.</span><span class="na">prevent=</span><span class="s">"logout"</span> <span class="na">v-else</span><span class="nt">&gt;</span>Logout<span class="nt">&lt;/b-nav-item&gt;</span>
        <span class="nt">&lt;/b-navbar-nav&gt;</span>
      <span class="nt">&lt;/b-collapse&gt;</span>
    <span class="nt">&lt;/b-navbar&gt;</span>
    <span class="c">&lt;!-- routes will be rendered here --&gt;</span>
    <span class="nt">&lt;router-view</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script&gt;</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="s1">'app'</span><span class="p">,</span>
  <span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">activeUser</span><span class="p">:</span> <span class="kc">null</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="k">async</span> <span class="nx">created</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshActiveUser</span><span class="p">()</span>
  <span class="p">},</span>
  <span class="na">watch</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// everytime a route is changed refresh the activeUser</span>
    <span class="s1">'$route'</span><span class="p">:</span> <span class="s1">'refreshActiveUser'</span>
  <span class="p">},</span>
  <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">login</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">loginRedirect</span><span class="p">()</span>
    <span class="p">},</span>
    <span class="k">async</span> <span class="nx">refreshActiveUser</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">activeUser</span> <span class="o">=</span> <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">getUser</span><span class="p">()</span>
    <span class="p">},</span>
    <span class="k">async</span> <span class="nx">logout</span> <span class="p">()</span> <span class="p">{</span>
      <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">logout</span><span class="p">()</span>
      <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshActiveUser</span><span class="p">()</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Every login must have a logout. The following snippet will logout your user, refresh the active user (which is now null), and then redirect the user to the homepage. This method is called when a user clicks on the logout link in the nav.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">logout</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">logout</span><span class="p">()</span>
  <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshActiveUser</span><span class="p">()</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">$router</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p><a href="https://vuejs.org/v2/guide/components">Components</a> are the building blocks within Vue.js.  Each of your pages will be defined in the app as a component. Since the vue-cli webpack template utilizes <a href="https://github.com/vuejs/vue-loader">vue-loader</a>, your component source files have a convention that separates template, script, and style (<a href="https://github.com/vuejs/vue-loader">see here</a>).</p>

<p>Now that you’ve added vue-bootstrap, modify <code class="highlighter-rouge">./src/components/Hello.vue</code> to remove the boilerplate links vue-cli generates.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"hero"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
      <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"display-3"</span><span class="nt">&gt;</span>Hello World<span class="nt">&lt;/h1&gt;</span>
      <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"lead"</span><span class="nt">&gt;</span>This is the homepage of your vue app<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;style&gt;</span>
  <span class="nc">.hero</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">90vh</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="nl">justify-content</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.hero</span> <span class="nc">.lead</span> <span class="p">{</span>
    <span class="nl">font-weight</span><span class="p">:</span> <span class="m">200</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">1.5rem</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre></div></div>

<p>At this point you can stub out the Post Manager page to test your authentication flow. Once you confirm authentication works, you’ll start to build out the API calls and components required to perform CRUD operations on your Posts model.</p>

<p>Create a new file <code class="highlighter-rouge">./src/components/PostsManager.vue</code> and paste the following code:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid mt-4"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"h1"</span><span class="nt">&gt;</span>Posts Manager<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;p&gt;</span>Only authenticated users should see this page<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div>

<h2 id="take-your-vuejs-frontend-and-auth-flows-for-a-test-drive">Take Your Vue.js Frontend and Auth Flows for a Test Drive</h2>

<p>In your terminal run <code class="highlighter-rouge">npm run dev</code> (if it’s not already running). Navigate to <code class="highlighter-rouge">http://localhost:8080</code> and you should see the new homepage.</p>

<p><img src="/assets/blog/vue-crud-node/new-homepage-7bbf1b612f5d02bff93d2a233345bfa0d621a5b1ec1cde5d8a40dd8b7998ff50.png" alt="Hello World" width="800" class="center-image" /></p>

<p>If you click <strong>Posts Manager</strong> or <strong>Login</strong> you should be directed to Okta’s flow.  Enter your Okta dev account credentials.</p>

<p><strong>NOTE:</strong> If you are logged in to your Okta Developer Account you will be redirected automatically back to the app. You can test this by using incognito or private browsing mode.</p>

<p><img src="/assets/blog/vue-crud-node/okta-sign-in-84e74fdcd14ea14cfef67942450ef280e251773e6621e8c4d8fbeb585f5ab068.png" alt="Okta Sign-In" width="800" class="center-image" /></p>

<p>If successful, you should return to the homepage logged in.</p>

<p><img src="/assets/blog/vue-crud-node/homepage-authenticated-12cf39e1a94d81657ebf0ba6d02b42c61f59d81ed911b13a00968742397ff7d5.png" alt="Homepage after logging in" width="800" class="center-image" /></p>

<p>Clicking on <strong>Posts Manager</strong> link should render the protected component.</p>

<p><img src="/assets/blog/vue-crud-node/posts-manager-e371e794a03cd91955e0bc4661a5f6a0649f4532ebde18531fb23997dd174849.png" alt="Posts Manager" width="800" class="center-image" /></p>

<h2 id="add-a-backend-rest-api-server">Add a Backend REST API Server</h2>

<p>Now that users can securely authenticate, you can build the REST API server to perform CRUD operations on a post model. Add the following dependencies to your project:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm i --save express cors @okta/jwt-verifier sequelize sqlite3 epilogue axios
</code></pre></div></div>

<p>Then, create the file  <code class="highlighter-rouge">./src/server.js</code> and paste the following code.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">cors</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'cors'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'body-parser'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">Sequelize</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'sequelize'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">epilogue</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'epilogue'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">OktaJwtVerifier</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'@okta/jwt-verifier'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">oktaJwtVerifier</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">OktaJwtVerifier</span><span class="p">({</span>
  <span class="na">clientId</span><span class="p">:</span> <span class="s1">'{yourClientId}'</span><span class="p">,</span>
  <span class="na">issuer</span><span class="p">:</span> <span class="s1">'<span class="okta-preview-domain"><span class="okta-preview-domain">https://{yourOktaDomain}.com</span></span>/oauth2/default'</span>
<span class="p">})</span>

<span class="kd">let</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">cors</span><span class="p">())</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>

<span class="c1">// verify JWT token middleware</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// require every request to have an authorization header</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">authorization</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">next</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'Authorization header is required'</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="kd">let</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">authorization</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span>
  <span class="kd">let</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
  <span class="nx">oktaJwtVerifier</span><span class="p">.</span><span class="nx">verifyAccessToken</span><span class="p">(</span><span class="nx">accessToken</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">jwt</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">uid</span><span class="p">:</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">claims</span><span class="p">.</span><span class="nx">uid</span><span class="p">,</span>
        <span class="na">email</span><span class="p">:</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">claims</span><span class="p">.</span><span class="nx">sub</span>
      <span class="p">}</span>
      <span class="nx">next</span><span class="p">()</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">next</span><span class="p">)</span> <span class="c1">// jwt did not verify!</span>
<span class="p">})</span>

<span class="c1">// For ease of this tutorial, we are going to use SQLite to limit dependencies</span>
<span class="kd">let</span> <span class="nx">database</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sequelize</span><span class="p">({</span>
  <span class="na">dialect</span><span class="p">:</span> <span class="s1">'sqlite'</span><span class="p">,</span>
  <span class="na">storage</span><span class="p">:</span> <span class="s1">'./test.sqlite'</span>
<span class="p">})</span>

<span class="c1">// Define our Post model</span>
<span class="c1">// id, createdAt, and updatedAt are added by sequelize automatically</span>
<span class="kd">let</span> <span class="nx">Post</span> <span class="o">=</span> <span class="nx">database</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">'posts'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">title</span><span class="p">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">STRING</span><span class="p">,</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">TEXT</span>
<span class="p">})</span>

<span class="c1">// Initialize epilogue</span>
<span class="nx">epilogue</span><span class="p">.</span><span class="nx">initialize</span><span class="p">({</span>
  <span class="na">app</span><span class="p">:</span> <span class="nx">app</span><span class="p">,</span>
  <span class="na">sequelize</span><span class="p">:</span> <span class="nx">database</span>
<span class="p">})</span>

<span class="c1">// Create the dynamic REST resource for our Post model</span>
<span class="kd">let</span> <span class="nx">userResource</span> <span class="o">=</span> <span class="nx">epilogue</span><span class="p">.</span><span class="nx">resource</span><span class="p">({</span>
  <span class="na">model</span><span class="p">:</span> <span class="nx">Post</span><span class="p">,</span>
  <span class="na">endpoints</span><span class="p">:</span> <span class="p">[</span><span class="s1">'/posts'</span><span class="p">,</span> <span class="s1">'/posts/:id'</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1">// Resets the database and launches the express app on :8081</span>
<span class="nx">database</span>
  <span class="p">.</span><span class="nx">sync</span><span class="p">({</span> <span class="na">force</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">8081</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'listening to port localhost:8081'</span><span class="p">)</span>
    <span class="p">})</span>
  <span class="p">})</span>
</code></pre></div></div>

<p>Make sure to replace the variables <code class="highlighter-rouge">{yourOktaDomain}</code> and <code class="highlighter-rouge">{clientId}</code> in the above code with values from your OIDC app in Okta.</p>

<h3 id="add-sequelize">Add Sequelize</h3>

<p><a href="https://github.com/sequelize/sequelize">Sequelize</a> is a promise-based ORM for Node.js. It supports the dialects PostgreSQL, MySQL, SQLite, and MSSQL and features solid transaction support, relations, read replication, and more.</p>

<p>For ease of this tutorial, you’re going to use SQLite to limit external dependencies. The following code initializes a Sequelize instance using SQLite as your driver.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">database</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sequelize</span><span class="p">({</span>
  <span class="na">dialect</span><span class="p">:</span> <span class="s1">'sqlite'</span><span class="p">,</span>
  <span class="na">storage</span><span class="p">:</span> <span class="s1">'./test.sqlite'</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Each post has a <code class="highlighter-rouge">title</code> and <code class="highlighter-rouge">body</code>. (The fields <code class="highlighter-rouge">createdAt</code>, and <code class="highlighter-rouge">updatedAt</code> are added by Sequelize automatically). With Sequelize, you define models by calling <code class="highlighter-rouge">define()</code> on your instance.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let Post = database.define('posts', {
  title: Sequelize.STRING,
  body: Sequelize.TEXT
})
</code></pre></div></div>

<h2 id="add-epilogue">Add Epilogue</h2>

<p><a href="https://github.com/dchester/epilogue">Epilogue</a> creates flexible REST endpoints from Sequelize models within an Express app. If you ever coded REST endpoints you know how much repetition there is. D.R.Y. FTW!</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Initialize epilogue</span>
<span class="nx">epilogue</span><span class="p">.</span><span class="nx">initialize</span><span class="p">({</span>
  <span class="na">app</span><span class="p">:</span> <span class="nx">app</span><span class="p">,</span>
  <span class="na">sequelize</span><span class="p">:</span> <span class="nx">database</span>
<span class="p">})</span>

<span class="c1">// Create the dynamic REST resource for our Post model</span>
<span class="kd">let</span> <span class="nx">userResource</span> <span class="o">=</span> <span class="nx">epilogue</span><span class="p">.</span><span class="nx">resource</span><span class="p">({</span>
  <span class="na">model</span><span class="p">:</span> <span class="nx">Post</span><span class="p">,</span>
  <span class="na">endpoints</span><span class="p">:</span> <span class="p">[</span><span class="s1">'/posts'</span><span class="p">,</span> <span class="s1">'/posts/:id'</span><span class="p">]</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="verify-your-jwt">Verify Your JWT</h3>

<p>This is the most crucial component of your REST API server. Without this middleware any user can perform CRUD operations on our database. If no authorization header is present, or the access token is invalid, the API call will fail and return an error.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// verify JWT token middleware</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// require every request to have an authorization header</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">authorization</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">next</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'Authorization header is required'</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="kd">let</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nx">authorization</span><span class="p">.</span><span class="nx">trim</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span>
  <span class="kd">let</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">pop</span><span class="p">()</span>
  <span class="nx">oktaJwtVerifier</span><span class="p">.</span><span class="nx">verifyAccessToken</span><span class="p">(</span><span class="nx">accessToken</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">jwt</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">req</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">uid</span><span class="p">:</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">claims</span><span class="p">.</span><span class="nx">uid</span><span class="p">,</span>
        <span class="na">email</span><span class="p">:</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">claims</span><span class="p">.</span><span class="nx">sub</span>
      <span class="p">}</span>
      <span class="nx">next</span><span class="p">()</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">next</span><span class="p">)</span> <span class="c1">// jwt did not verify!</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="run-the-server">Run the Server</h3>

<p>Open a new terminal window and run the server with the command <code class="highlighter-rouge">node ./src/server</code>.  You should see debug information from Sequelize and the app listening on port 8081.</p>

<h2 id="complete-the-posts-manager-component">Complete the Posts Manager Component</h2>

<p>Now that the REST API server is complete, you can start wiring up your posts manager to fetch posts, create posts, edit posts, and delete posts.</p>

<p>I always centralize my API integrations into a single helper module. This keeps the code in components much cleaner and provides single location in case you need to change anything with the API request.</p>

<p>Create a file <code class="highlighter-rouge">./src/api.js</code> and copy/paste the following code into it:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="s1">'vue'</span>
<span class="k">import</span> <span class="nx">axios</span> <span class="k">from</span> <span class="s1">'axios'</span>

<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">baseURL</span><span class="p">:</span> <span class="s1">'http://localhost:8081/'</span><span class="p">,</span>
  <span class="na">json</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">})</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">execute</span> <span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">resource</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// inject the accessToken for each request</span>
    <span class="kd">let</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">getAccessToken</span><span class="p">()</span>
    <span class="k">return</span> <span class="nx">client</span><span class="p">({</span>
      <span class="nx">method</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="nx">resource</span><span class="p">,</span>
      <span class="nx">data</span><span class="p">,</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">Authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">accessToken</span><span class="p">}</span><span class="s2">`</span>
      <span class="p">}</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">req</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">req</span><span class="p">.</span><span class="nx">data</span>
    <span class="p">})</span>
  <span class="p">},</span>
  <span class="nx">getPosts</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="s1">'/posts'</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="nx">getPost</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="s2">`/posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="nx">createPost</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'post'</span><span class="p">,</span> <span class="s1">'/posts'</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="nx">updatePost</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'put'</span><span class="p">,</span> <span class="s2">`/posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="nx">deletePost</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'delete'</span><span class="p">,</span> <span class="s2">`/posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When you authenticate with OIDC, an access token is persisted locally in the browser.  Since each API request must have an access token, you can fetch it from the authentication client and set it in the request.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">accessToken</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Vue</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">$auth</span><span class="p">.</span><span class="nx">getAccessToken</span><span class="p">()</span>
<span class="k">return</span> <span class="nx">client</span><span class="p">({</span>
  <span class="nx">method</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="nx">resource</span><span class="p">,</span>
  <span class="nx">data</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">accessToken</span><span class="p">}</span><span class="s2">`</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>By creating the following proxy methods inside your API helper, the code outside the helper module remains clean and semantic.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">getPosts</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="s1">'/posts'</span><span class="p">)</span>
<span class="p">},</span>
<span class="nx">getPost</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'get'</span><span class="p">,</span> <span class="s2">`/posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
<span class="p">},</span>
<span class="nx">createPost</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'post'</span><span class="p">,</span> <span class="s1">'/posts'</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
<span class="p">},</span>
<span class="nx">updatePost</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'put'</span><span class="p">,</span> <span class="s2">`/posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
<span class="p">},</span>
<span class="nx">deletePost</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="s1">'delete'</span><span class="p">,</span> <span class="s2">`/posts/</span><span class="p">${</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You now have all the components required to wire up your posts manager component to make CRUD operations via the REST API. Open <code class="highlighter-rouge">./src/components/PostsManager.vue</code> and copy/paste the following code.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container-fluid mt-4"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"h1"</span><span class="nt">&gt;</span>Posts Manager<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;b-alert</span> <span class="na">:show=</span><span class="s">"loading"</span> <span class="na">variant=</span><span class="s">"info"</span><span class="nt">&gt;</span>Loading...<span class="nt">&lt;/b-alert&gt;</span>
    <span class="nt">&lt;b-row&gt;</span>
      <span class="nt">&lt;b-col&gt;</span>
        <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table table-striped"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
              <span class="nt">&lt;th&gt;</span>ID<span class="nt">&lt;/th&gt;</span>
              <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
              <span class="nt">&lt;th&gt;</span>Updated At<span class="nt">&lt;/th&gt;</span>
              <span class="nt">&lt;th&gt;</span><span class="ni">&amp;nbsp;</span><span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;/thead&gt;</span>
          <span class="nt">&lt;tbody&gt;</span>
            <span class="nt">&lt;tr</span> <span class="na">v-for=</span><span class="s">"post in posts"</span> <span class="na">:key=</span><span class="s">"post.id"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;td&gt;</span>{{ post.id }}<span class="nt">&lt;/td&gt;</span>
              <span class="nt">&lt;td&gt;</span>{{ post.title }}<span class="nt">&lt;/td&gt;</span>
              <span class="nt">&lt;td&gt;</span>{{ post.updatedAt }}<span class="nt">&lt;/td&gt;</span>
              <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"text-right"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="err">@</span><span class="na">click</span><span class="err">.</span><span class="na">prevent=</span><span class="s">"populatePostToEdit(post)"</span><span class="nt">&gt;</span>Edit<span class="nt">&lt;/a&gt;</span> - 
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="err">@</span><span class="na">click</span><span class="err">.</span><span class="na">prevent=</span><span class="s">"deletePost(post.id)"</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
              <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
          <span class="nt">&lt;/tbody&gt;</span>
        <span class="nt">&lt;/table&gt;</span>
      <span class="nt">&lt;/b-col&gt;</span>
      <span class="nt">&lt;b-col</span> <span class="na">lg=</span><span class="s">"3"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;b-card</span> <span class="na">:title=</span><span class="s">"(model.id ? 'Edit Post ID#' + model.id : 'New Post')"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;form</span> <span class="err">@</span><span class="na">submit</span><span class="err">.</span><span class="na">prevent=</span><span class="s">"savePost"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;b-form-group</span> <span class="na">label=</span><span class="s">"Title"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;b-form-input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">v-model=</span><span class="s">"model.title"</span><span class="nt">&gt;&lt;/b-form-input&gt;</span>
            <span class="nt">&lt;/b-form-group&gt;</span>
            <span class="nt">&lt;b-form-group</span> <span class="na">label=</span><span class="s">"Body"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;b-form-textarea</span> <span class="na">rows=</span><span class="s">"4"</span> <span class="na">v-model=</span><span class="s">"model.body"</span><span class="nt">&gt;&lt;/b-form-textarea&gt;</span>
            <span class="nt">&lt;/b-form-group&gt;</span>
            <span class="nt">&lt;div&gt;</span>
              <span class="nt">&lt;b-btn</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">variant=</span><span class="s">"success"</span><span class="nt">&gt;</span>Save Post<span class="nt">&lt;/b-btn&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
          <span class="nt">&lt;/form&gt;</span>
        <span class="nt">&lt;/b-card&gt;</span>
      <span class="nt">&lt;/b-col&gt;</span>
    <span class="nt">&lt;/b-row&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>

<span class="nt">&lt;script&gt;</span>
<span class="k">import</span> <span class="nx">api</span> <span class="k">from</span> <span class="s1">'@/api'</span>
<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="na">loading</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">posts</span><span class="p">:</span> <span class="p">[],</span>
      <span class="na">model</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="k">async</span> <span class="nx">created</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">refreshPosts</span><span class="p">()</span>
  <span class="p">},</span>
  <span class="na">methods</span><span class="p">:</span> <span class="p">{</span>
    <span class="k">async</span> <span class="nx">refreshPosts</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">true</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getPosts</span><span class="p">()</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">},</span>
    <span class="k">async</span> <span class="nx">populatePostToEdit</span> <span class="p">(</span><span class="nx">post</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">post</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="k">async</span> <span class="nx">savePost</span> <span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">updatePost</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">createPost</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">// reset form</span>
      <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshPosts</span><span class="p">()</span>
    <span class="p">},</span>
    <span class="k">async</span> <span class="nx">deletePost</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s1">'Are you sure you want to delete this post?'</span><span class="p">))</span> <span class="p">{</span>
        <span class="c1">// if we are editing a post we deleted, remove it from the form</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="p">}</span>
        <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">deletePost</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
        <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshPosts</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<h3 id="listing-posts">Listing Posts</h3>

<p>You’ll use <code class="highlighter-rouge">api.getPosts()</code> to fetch posts from your REST API server. You should refresh the list of posts when the component is loaded and after any mutating operation (create, update, or delete).</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">refreshPosts</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">getPosts</span><span class="p">()</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">loading</span> <span class="o">=</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The attribute <code class="highlighter-rouge">this.loading</code> is toggled so the UI can reflect the pending API call. You might not see the loading message since the API request is not going out to the internet.</p>

<h3 id="creating-posts">Creating Posts</h3>

<p>A form is included in the component to save a post. It’s wired up to call <code class="highlighter-rouge">savePosts()</code> when the form is submitted and its inputs are bound to the <code class="highlighter-rouge">model</code> object on the component.</p>

<p>When <code class="highlighter-rouge">savePost()</code> is called, it will perform either an update or create based on the existence of <code class="highlighter-rouge">model.id</code>. This is mostly a shortcut to not have to define two separate forms for creating and updating.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">savePost</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">updatePost</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">createPost</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1">// reset form</span>
  <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshPosts</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="updating-posts">Updating Posts</h3>

<p>When updating a post, you first must load the post into the form. This sets <code class="highlighter-rouge">model.id</code> which will the trigger an update in <code class="highlighter-rouge">savePost()</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">populatePostToEdit</span> <span class="p">(</span><span class="nx">post</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({},</span> <span class="nx">post</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Important:</strong> The <code class="highlighter-rouge">Object.assign()</code> call copies the value of the post argument rather than the reference. When dealing with mutation of objects in Vue, you should always set to the value, not reference.</p>

<h3 id="deleting-posts">Deleting Posts</h3>

<p>To delete a post simply call <code class="highlighter-rouge">api.deletePost(id)</code>. It’s always good to confirm before delete so let’s throw in a native confirmation alert box to make sure the click was intentional.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="nx">deletePost</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">confirm</span><span class="p">(</span><span class="s1">'Are you sure you want to delete this post?'</span><span class="p">))</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="nx">api</span><span class="p">.</span><span class="nx">deletePost</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
    <span class="kr">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">refreshPosts</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="test-your-vuejs--node-crud-app">Test Your Vue.js + Node CRUD App</h2>

<p>Make sure both the server and frontend are running.</p>

<p>Terminal #1</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node ./src/server
</code></pre></div></div>

<p>Terminal #2</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm run dev
</code></pre></div></div>

<p>Navigate to <code class="highlighter-rouge">http://localhost:8080</code> and give it a whirl.</p>

<p><img src="/assets/blog/vue-crud-node/new-post-464637114d9c541ea48aa4dcc9fb698d6d5bf99cd2a3e5b39d81ffca6f7c406d.png" alt="New Post" width="800" class="center-image" /></p>

<p><img src="/assets/blog/vue-crud-node/new-post-hello-world-357d85f922ecea2f414b35dbb90c310279e388d20da655c196fda04328c4a223.png" alt="New Hello World Post" width="800" class="center-image" /></p>

<p><img src="/assets/blog/vue-crud-node/delete-post-3e5ec6eb05128b65782c45bfcf7dd1129579a57175141d9fb1cfcc776cd2efad.png" alt="Delete Post" width="800" class="center-image" /></p>

<h2 id="do-more-with-vue">Do More With Vue!</h2>

<p>As I said at the top of this post, I think Vue stands head and shoulders above other frameworks. Here are five quick reasons why:</p>

<ul>
  <li><a href="https://vuejs.org/v2/guide/instance#Lifecycle-Diagram">Simple component lifecycle</a></li>
  <li><a href="https://vuejs.org/v2/guide/syntax">HTML-based templating</a> and native <a href="https://vuejs.org/v2/guide/forms">two-way binding</a></li>
  <li>Widely agreed upon ways to handle <a href="https://github.com/vuejs/vue-router">routing</a>, <a href="https://github.com/vuejs/vuex">state management</a>, <a href="https://github.com/vuejs/vue-loader">webpack configuration</a>, and <a href="https://nuxtjs.org/">isomorphic web apps</a></li>
  <li>Massive community supported <a href="https://github.com/vuejs/awesome-vue">resources, components, libraries, and projects</a></li>
  <li>Vue feels very similar to <a href="https://github.com/facebook/react">React</a> (without the JSX!) which lowers the barrier to entry for those with React experience. Moving between React and Vue isn’t very difficult.</li>
</ul>

<p>I covered a lot of material in this tutorial but don’t feel bad if you didn’t grasp everything the first time. The more you work with these technologies, the more familiar they will become.</p>

<p>To learn more about Vue.js head over to <a href="https://vuejs.org/">https://vuejs.org</a> or check out these other great resources from the <a href="https://twitter.com/OktaDev">@oktadev team</a>:</p>
<ul>
  <li><a href="/blog/2017/07/20/the-ultimate-guide-to-progressive-web-applications">The Ultimate Guide to Progressive Web Applications</a></li>
  <li><a href="/blog/2017/09/14/lazy-developers-guide-to-auth-with-vue">The Lazy Developer’s Guide to Authentication with Vue.js</a></li>
  <li><a href="/blog/2017/09/06/build-a-cryptocurrency-comparison-site-with-vuejs">Build a Cryptocurrency Comparison Site with Vue.js</a></li>
</ul>

<p>Hit me up in the comments with any questions, and as always, follow <a href="https://twitter.com/OktaDev">@oktadev</a> on Twitter to see all the cool content our dev team is creating.</p>


    </div>

    
    <div id="disqus">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_title = 'Build a Basic CRUD App with Vue.js and Node';
            var disqus_url = 'https://developer.okta.com/blog/2018/02/15/build-crud-app-vuejs-node';

            (function () {
                var dsq = document.createElement('script');
                dsq.async = true;
                dsq.type = 'text/javascript';
                dsq.src = '//oktadevblog.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
          <noscript>
              Please enable JavaScript to view the
              <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus</a>.
         </noscript>
    </div>
    
</article>

		
</section>

		
	</div><footer class="Footer">
    <div class="Wrap">

        <div class="Row">

            <div class="Column--3 Column--medium-6 Column--xSmall-12">

                <a class="Logo" href="https://www.okta.com/" target="_blank" rel="noopener noreferrer">
                    <img src="https://developer.okta.com/sites/all/themes/developer/images/logo-footer.png" alt="Okta">
                    Visit okta.com
                </a>

            </div>

            <div class="Column--3 Column--medium-12 Column--xSmall-12">

                <h4>Social</h4>
                <ul class="Footer-links Footer-links--social">
                    <li><a class="Footer-links--github" target="_blank" rel="noopener noreferrer" href="http://github.com/oktadeveloper">Github</a></li>
                    <li><a class="Footer-links--twitter" target="_blank" rel="noopener noreferrer" href="http://twitter.com/OktaDev">Twitter</a></li>
                    <li><a class="Footer-links--forum" target="_blank" rel="noopener noreferrer" href="https://devforum.okta.com/">Forum</a></li>
                    <li><a class="Footer-links--rss" target="_blank" rel="noopener noreferrer" href="http://feeds.feedburner.com/OktaBlog">RSS Blog</a></li>
                </ul>
            </div>

            <div class="Column--3 Column--medium-6 Column--small-12">
                <h4>More Info</h4>
                <ul class="Footer-links">
                    <li><a target="_blank" href="https://developer.okta.com/integrate-with-okta/">Integrate with Okta</a></li>
                    <li><a href="/blog/">Blog</a></li>
                    <li><a href="/docs/change-log/">Change Log</a></li>
                    <li><a href="/3rd_party_notices/">3rd Party Notices</a></li>
                </ul>
            </div>

            <div class="Column--3 Column--medium-6 Column--small-12">
                <h4>Contact &amp; Legal</h4>
                <ul class="Footer-links">
                    <li><a href="https://developer.okta.com/contact/">Contact Sales</a></li>
                    <li><a target="_blank" rel="noopener noreferrer" href="mailto:developers@okta.com">Contact Support</a></li>
                    <li><a href="https://developer.okta.com/terms/">Terms &amp; Conditions</a></li>
                    <li><a href="https://developer.okta.com/privacy/">Privacy Policy</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script type="text/javascript" src="/assets/master-aa397c892d9083236c5cb20732dde679021b9236c8142ce78177b8b184567a02.js"></script>
    <script type="text/javascript" src="/assets/myOkta-911cbafbbe079b7a5522d9cbe15bd2a5f44e1582531e88393934bec69f97696b.js"></script>
    
    
    
    
      <script type="text/javascript" src="/assets/blog-6e32dad27404131cc8630a5282264bed2ab4c08c91ac86fa496b75c53aa4f681.js"></script>
    

  <!-- START Post Footer -->
  
  <!-- START Google Tag Manager -->
  <!-- https://support.google.com/tagmanager/answer/6103696?hl=en -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- END Google Tag Manager -->
  <!-- START Google Remarketing Tag -->
  <script type="text/javascript">
    /* <![CDATA[ */
    var google_conversion_id = 1006913831;
    var google_custom_params = window.google_tag_params;
    var google_remarketing_only = true;
    /* ]]> */
  </script>
  <div style="display:none;"><script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script></div>
  <noscript><div style="display:inline;"><img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1006913831/?value=0&amp;guid=ON&amp;script=0"></div></noscript>
  <!-- END Google Remarketing Tag -->
  <!-- START Crazy Egg Tracking -->
  <script type="text/javascript">
    setTimeout(function(){var a=document.createElement("script");
    var b=document.getElementsByTagName("script")[0];
    a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0021/9333.js?"+Math.floor(new Date().getTime()/3600000);
    a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>
  <!-- END Crazy Egg Tracking -->

  <!-- END Post Footer -->
</body>
</html>
